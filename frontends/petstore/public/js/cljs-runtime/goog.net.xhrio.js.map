{
"version":3,
"file":"goog.net.xhrio.js",
"lineCount":490,
"mappings":"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",
"sources":["goog/net/xhrio.js"],
"sourcesContent":["/**\n * @license\n * Copyright The Closure Library Authors.\n * SPDX-License-Identifier: Apache-2.0\n */\n\n/**\n * @fileoverview Wrapper class for handling XmlHttpRequests.\n *\n * One off requests can be sent through goog.net.XhrIo.send() or an\n * instance can be created to send multiple requests.  Each request uses its\n * own XmlHttpRequest object and handles clearing of the event callback to\n * ensure no leaks.\n *\n * XhrIo is event based, it dispatches events on success, failure, finishing,\n * ready-state change, or progress (download and upload).\n *\n * The ready-state or timeout event fires first, followed by\n * a generic completed event. Then the abort, error, or success event\n * is fired as appropriate. Progress events are fired as they are\n * received. Lastly, the ready event will fire to indicate that the\n * object may be used to make another request.\n *\n * The error event may also be called before completed and\n * ready-state-change if the XmlHttpRequest.open() or .send() methods throw.\n *\n * This class does not support multiple requests, queuing, or prioritization.\n *\n * When progress events are supported by the browser, and progress is\n * enabled via .setProgressEventsEnabled(true), the\n * goog.net.EventType.PROGRESS event will be the re-dispatched browser\n * progress event. Additionally, a DOWNLOAD_PROGRESS or UPLOAD_PROGRESS event\n * will be fired for download and upload progress respectively.\n */\n\n\ngoog.provide('goog.net.XhrIo');\ngoog.provide('goog.net.XhrIo.ResponseType');\n\ngoog.require('goog.Timer');\ngoog.require('goog.array');\ngoog.require('goog.asserts');\ngoog.require('goog.collections.maps');\ngoog.require('goog.debug.entryPointRegistry');\ngoog.require('goog.events.EventTarget');\ngoog.require('goog.json.hybrid');\ngoog.require('goog.log');\ngoog.require('goog.net.ErrorCode');\ngoog.require('goog.net.EventType');\ngoog.require('goog.net.HttpStatus');\ngoog.require('goog.net.XmlHttp');\ngoog.require('goog.object');\ngoog.require('goog.string');\ngoog.require('goog.uri.utils');\ngoog.require('goog.userAgent');\ngoog.requireType('goog.Uri');\ngoog.requireType('goog.debug.ErrorHandler');\ngoog.requireType('goog.net.XhrLike');\ngoog.requireType('goog.net.XmlHttpFactory');\n\ngoog.scope(function() {\n\n'use strict';\n/**\n * Basic class for handling XMLHttpRequests.\n * @param {goog.net.XmlHttpFactory=} opt_xmlHttpFactory Factory to use when\n *     creating XMLHttpRequest objects.\n * @constructor\n * @extends {goog.events.EventTarget}\n */\ngoog.net.XhrIo = function(opt_xmlHttpFactory) {\n  'use strict';\n  XhrIo.base(this, 'constructor');\n\n  /**\n   * Map of default headers to add to every request, use:\n   * XhrIo.headers.set(name, value)\n   * @type {!Map<string,string>}\n   */\n  this.headers = new Map();\n\n  /**\n   * Optional XmlHttpFactory\n   * @private {goog.net.XmlHttpFactory}\n   */\n  this.xmlHttpFactory_ = opt_xmlHttpFactory || null;\n\n  /**\n   * Whether XMLHttpRequest is active.  A request is active from the time send()\n   * is called until onReadyStateChange() is complete, or error() or abort()\n   * is called.\n   * @private {boolean}\n   */\n  this.active_ = false;\n\n  /**\n   * The XMLHttpRequest object that is being used for the transfer.\n   * @private {?goog.net.XhrLike.OrNative}\n   */\n  this.xhr_ = null;\n\n  /**\n   * The options to use with the current XMLHttpRequest object.\n   * @private {?Object}\n   */\n  this.xhrOptions_ = null;\n\n  /**\n   * Last URL that was requested.\n   * @private {string|goog.Uri}\n   */\n  this.lastUri_ = '';\n\n  /**\n   * Method for the last request.\n   * @private {string}\n   */\n  this.lastMethod_ = '';\n\n  /**\n   * Last error code.\n   * @private {!goog.net.ErrorCode}\n   */\n  this.lastErrorCode_ = goog.net.ErrorCode.NO_ERROR;\n\n  /**\n   * Last error message.\n   * @private {Error|string}\n   */\n  this.lastError_ = '';\n\n  /**\n   * Used to ensure that we don't dispatch an multiple ERROR events. This can\n   * happen in IE when it does a synchronous load and one error is handled in\n   * the ready state change and one is handled due to send() throwing an\n   * exception.\n   * @private {boolean}\n   */\n  this.errorDispatched_ = false;\n\n  /**\n   * Used to make sure we don't fire the complete event from inside a send call.\n   * @private {boolean}\n   */\n  this.inSend_ = false;\n\n  /**\n   * Used in determining if a call to {@link #onReadyStateChange_} is from\n   * within a call to this.xhr_.open.\n   * @private {boolean}\n   */\n  this.inOpen_ = false;\n\n  /**\n   * Used in determining if a call to {@link #onReadyStateChange_} is from\n   * within a call to this.xhr_.abort.\n   * @private {boolean}\n   */\n  this.inAbort_ = false;\n\n  /**\n   * Number of milliseconds after which an incomplete request will be aborted\n   * and a {@link goog.net.EventType.TIMEOUT} event raised; 0 means no timeout\n   * is set.\n   * @private {number}\n   */\n  this.timeoutInterval_ = 0;\n\n  /**\n   * Timer to track request timeout.\n   * @private {?number}\n   */\n  this.timeoutId_ = null;\n\n  /**\n   * The requested type for the response. The empty string means use the default\n   * XHR behavior.\n   * @private {goog.net.XhrIo.ResponseType}\n   */\n  this.responseType_ = ResponseType.DEFAULT;\n\n  /**\n   * Whether a \"credentialed\" request is to be sent (one that is aware of\n   * cookies and authentication). This is applicable only for cross-domain\n   * requests and more recent browsers that support this part of the HTTP Access\n   * Control standard.\n   *\n   * @see http://www.w3.org/TR/XMLHttpRequest/#the-withcredentials-attribute\n   *\n   * @private {boolean}\n   */\n  this.withCredentials_ = false;\n\n  /**\n   * Whether progress events are enabled for this request. This is\n   * disabled by default because setting a progress event handler\n   * causes pre-flight OPTIONS requests to be sent for CORS requests,\n   * even in cases where a pre-flight request would not otherwise be\n   * sent.\n   *\n   * @see http://xhr.spec.whatwg.org/#security-considerations\n   *\n   * Note that this can cause problems for Firefox 22 and below, as an\n   * older \"LSProgressEvent\" will be dispatched by the browser. That\n   * progress event is no longer supported, and can lead to failures,\n   * including throwing exceptions.\n   *\n   * @see http://bugzilla.mozilla.org/show_bug.cgi?id=845631\n   * @see b/23469793\n   *\n   * @private {boolean}\n   */\n  this.progressEventsEnabled_ = false;\n\n  /**\n   * True if we can use XMLHttpRequest's timeout directly.\n   * @private {boolean}\n   */\n  this.useXhr2Timeout_ = false;\n\n  /**\n   * Specification for Trust Token operations (issuance, signing, and\n   * redemption).\n   * @private {?TrustTokenAttributeType}\n   */\n  this.trustToken_ = null;\n};\ngoog.inherits(goog.net.XhrIo, goog.events.EventTarget);\n\nconst XhrIo = goog.net.XhrIo;\n\n/**\n * Response types that may be requested for XMLHttpRequests.\n * @enum {string}\n * @see http://www.w3.org/TR/XMLHttpRequest/#the-responsetype-attribute\n */\ngoog.net.XhrIo.ResponseType = {\n  DEFAULT: '',\n  TEXT: 'text',\n  DOCUMENT: 'document',\n  // Not supported as of Chrome 10.0.612.1 dev\n  BLOB: 'blob',\n  ARRAY_BUFFER: 'arraybuffer',\n};\n\nconst ResponseType = goog.net.XhrIo.ResponseType;\n\n\n/**\n * A reference to the XhrIo logger\n * @private {?goog.log.Logger}\n * @const\n */\ngoog.net.XhrIo.prototype.logger_ = goog.log.getLogger('goog.net.XhrIo');\n\n\n/**\n * The Content-Type HTTP header name\n * @type {string}\n */\ngoog.net.XhrIo.CONTENT_TYPE_HEADER = 'Content-Type';\n\n\n/**\n * The Content-Transfer-Encoding HTTP header name\n * @type {string}\n */\ngoog.net.XhrIo.CONTENT_TRANSFER_ENCODING = 'Content-Transfer-Encoding';\n\n\n/**\n * The pattern matching the 'http' and 'https' URI schemes\n * @type {!RegExp}\n */\ngoog.net.XhrIo.HTTP_SCHEME_PATTERN = /^https?$/i;\n\nconst HTTP_SCHEME_PATTERN = goog.net.XhrIo.HTTP_SCHEME_PATTERN;\n\n\n/**\n * The methods that typically come along with form data.  We set different\n * headers depending on whether the HTTP action is one of these.\n * @type {!Array<string>}\n */\ngoog.net.XhrIo.METHODS_WITH_FORM_DATA = ['POST', 'PUT'];\n\n\n/**\n * The Content-Type HTTP header value for a url-encoded form\n * @type {string}\n */\ngoog.net.XhrIo.FORM_CONTENT_TYPE =\n    'application/x-www-form-urlencoded;charset=utf-8';\n\n\n/**\n * The XMLHttpRequest Level two timeout delay ms property name.\n *\n * @see http://www.w3.org/TR/XMLHttpRequest/#the-timeout-attribute\n *\n * @private {string}\n * @const\n */\ngoog.net.XhrIo.XHR2_TIMEOUT_ = 'timeout';\n\n\n/**\n * The XMLHttpRequest Level two ontimeout handler property name.\n *\n * @see http://www.w3.org/TR/XMLHttpRequest/#the-timeout-attribute\n *\n * @private {string}\n * @const\n */\ngoog.net.XhrIo.XHR2_ON_TIMEOUT_ = 'ontimeout';\n\n\n/**\n * All non-disposed instances of goog.net.XhrIo created\n * by {@link goog.net.XhrIo.send} are in this Array.\n * @see goog.net.XhrIo.cleanup\n * @private {!Array<!goog.net.XhrIo>}\n */\ngoog.net.XhrIo.sendInstances_ = [];\n\n\n/**\n * Static send that creates a short lived instance of XhrIo to send the\n * request.\n * @see goog.net.XhrIo.cleanup\n * @param {string|goog.Uri} url Uri to make request to.\n * @param {?function(this:goog.net.XhrIo, ?)=} opt_callback Callback function\n *     for when request is complete.\n * @param {string=} opt_method Send method, default: GET.\n * @param {ArrayBuffer|ArrayBufferView|Blob|Document|FormData|string=}\n *     opt_content Body data.\n * @param {(?Object|?goog.collections.maps.MapLike<string, string>)=}\n *     opt_headers Map of headers to add to the request.\n * @param {number=} opt_timeoutInterval Number of milliseconds after which an\n *     incomplete request will be aborted; 0 means no timeout is set.\n * @param {boolean=} opt_withCredentials Whether to send credentials with the\n *     request. Default to false. See {@link goog.net.XhrIo#setWithCredentials}.\n * @return {!goog.net.XhrIo} The sent XhrIo.\n */\ngoog.net.XhrIo.send = function(\n    url, opt_callback, opt_method, opt_content, opt_headers,\n    opt_timeoutInterval, opt_withCredentials) {\n  'use strict';\n  const x = new goog.net.XhrIo();\n  goog.net.XhrIo.sendInstances_.push(x);\n  if (opt_callback) {\n    x.listen(goog.net.EventType.COMPLETE, opt_callback);\n  }\n  x.listenOnce(goog.net.EventType.READY, x.cleanupSend_);\n  if (opt_timeoutInterval) {\n    x.setTimeoutInterval(opt_timeoutInterval);\n  }\n  if (opt_withCredentials) {\n    x.setWithCredentials(opt_withCredentials);\n  }\n  x.send(url, opt_method, opt_content, opt_headers);\n  return x;\n};\n\n\n/**\n * Disposes all non-disposed instances of goog.net.XhrIo created by\n * {@link goog.net.XhrIo.send}.\n * {@link goog.net.XhrIo.send} cleans up the goog.net.XhrIo instance\n * it creates when the request completes or fails.  However, if\n * the request never completes, then the goog.net.XhrIo is not disposed.\n * This can occur if the window is unloaded before the request completes.\n * We could have {@link goog.net.XhrIo.send} return the goog.net.XhrIo\n * it creates and make the client of {@link goog.net.XhrIo.send} be\n * responsible for disposing it in this case.  However, this makes things\n * significantly more complicated for the client, and the whole point\n * of {@link goog.net.XhrIo.send} is that it's simple and easy to use.\n * Clients of {@link goog.net.XhrIo.send} should call\n * {@link goog.net.XhrIo.cleanup} when doing final\n * cleanup on window unload.\n */\ngoog.net.XhrIo.cleanup = function() {\n  'use strict';\n  const instances = goog.net.XhrIo.sendInstances_;\n  while (instances.length) {\n    instances.pop().dispose();\n  }\n};\n\n\n/**\n * Installs exception protection for all entry point introduced by\n * goog.net.XhrIo instances which are not protected by\n * {@link goog.debug.ErrorHandler#protectWindowSetTimeout},\n * {@link goog.debug.ErrorHandler#protectWindowSetInterval}, or\n * {@link goog.events.protectBrowserEventEntryPoint}.\n *\n * @param {goog.debug.ErrorHandler} errorHandler Error handler with which to\n *     protect the entry point(s).\n */\ngoog.net.XhrIo.protectEntryPoints = function(errorHandler) {\n  'use strict';\n  goog.net.XhrIo.prototype.onReadyStateChangeEntryPoint_ =\n      errorHandler.protectEntryPoint(\n          goog.net.XhrIo.prototype.onReadyStateChangeEntryPoint_);\n};\n\n\n/**\n * Disposes of the specified goog.net.XhrIo created by\n * {@link goog.net.XhrIo.send} and removes it from\n * {@link goog.net.XhrIo.pendingStaticSendInstances_}.\n * @private\n */\ngoog.net.XhrIo.prototype.cleanupSend_ = function() {\n  'use strict';\n  this.dispose();\n  goog.array.remove(goog.net.XhrIo.sendInstances_, this);\n};\n\n\n/**\n * Returns the number of milliseconds after which an incomplete request will be\n * aborted, or 0 if no timeout is set.\n * @return {number} Timeout interval in milliseconds.\n */\ngoog.net.XhrIo.prototype.getTimeoutInterval = function() {\n  'use strict';\n  return this.timeoutInterval_;\n};\n\n\n/**\n * Sets the number of milliseconds after which an incomplete request will be\n * aborted and a {@link goog.net.EventType.TIMEOUT} event raised; 0 means no\n * timeout is set.\n * @param {number} ms Timeout interval in milliseconds; 0 means none.\n */\ngoog.net.XhrIo.prototype.setTimeoutInterval = function(ms) {\n  'use strict';\n  this.timeoutInterval_ = Math.max(0, ms);\n};\n\n\n/**\n * Sets the desired type for the response. At time of writing, this is only\n * supported in very recent versions of WebKit (10.0.612.1 dev and later).\n *\n * If this is used, the response may only be accessed via {@link #getResponse}.\n *\n * @param {goog.net.XhrIo.ResponseType} type The desired type for the response.\n */\ngoog.net.XhrIo.prototype.setResponseType = function(type) {\n  'use strict';\n  this.responseType_ = type;\n};\n\n\n/**\n * Gets the desired type for the response.\n * @return {goog.net.XhrIo.ResponseType} The desired type for the response.\n */\ngoog.net.XhrIo.prototype.getResponseType = function() {\n  'use strict';\n  return this.responseType_;\n};\n\n\n/**\n * Sets whether a \"credentialed\" request that is aware of cookie and\n * authentication information should be made. This option is only supported by\n * browsers that support HTTP Access Control. As of this writing, this option\n * is not supported in IE.\n *\n * @param {boolean} withCredentials Whether this should be a \"credentialed\"\n *     request.\n */\ngoog.net.XhrIo.prototype.setWithCredentials = function(withCredentials) {\n  'use strict';\n  this.withCredentials_ = withCredentials;\n};\n\n\n/**\n * Gets whether a \"credentialed\" request is to be sent.\n * @return {boolean} The desired type for the response.\n */\ngoog.net.XhrIo.prototype.getWithCredentials = function() {\n  'use strict';\n  return this.withCredentials_;\n};\n\n\n/**\n * Sets whether progress events are enabled for this request. Note\n * that progress events require pre-flight OPTIONS request handling\n * for CORS requests, and may cause trouble with older browsers. See\n * progressEventsEnabled_ for details.\n * @param {boolean} enabled Whether progress events should be enabled.\n */\ngoog.net.XhrIo.prototype.setProgressEventsEnabled = function(enabled) {\n  'use strict';\n  this.progressEventsEnabled_ = enabled;\n};\n\n\n/**\n * Gets whether progress events are enabled.\n * @return {boolean} Whether progress events are enabled for this request.\n */\ngoog.net.XhrIo.prototype.getProgressEventsEnabled = function() {\n  'use strict';\n  return this.progressEventsEnabled_;\n};\n\n/**\n * Specify a Trust Tokens operation to execute alongside the request.\n * @param {!TrustTokenAttributeType} trustToken a Trust Tokens operation to\n *     execute.\n */\ngoog.net.XhrIo.prototype.setTrustToken = function(trustToken) {\n  'use strict';\n  this.trustToken_ = trustToken;\n};\n\n/**\n * Instance send that actually uses XMLHttpRequest to make a server call.\n * @param {string|goog.Uri} url Uri to make request to.\n * @param {string=} opt_method Send method, default: GET.\n * @param {ArrayBuffer|ArrayBufferView|Blob|Document|FormData|string=}\n *     opt_content Body data.\n * @param {(?Object|?goog.collections.maps.MapLike<string, string>)=}\n *     opt_headers Map of headers to add to the request.\n * @suppress {deprecated} Use deprecated goog.structs.forEach to allow different\n * types of parameters for opt_headers.\n */\ngoog.net.XhrIo.prototype.send = function(\n    url, opt_method, opt_content, opt_headers) {\n  'use strict';\n  if (this.xhr_) {\n    throw new Error(\n        '[goog.net.XhrIo] Object is active with another request=' +\n        this.lastUri_ + '; newUri=' + url);\n  }\n\n  const method = opt_method ? opt_method.toUpperCase() : 'GET';\n\n  this.lastUri_ = url;\n  this.lastError_ = '';\n  this.lastErrorCode_ = goog.net.ErrorCode.NO_ERROR;\n  this.lastMethod_ = method;\n  this.errorDispatched_ = false;\n  this.active_ = true;\n\n  // Use the factory to create the XHR object and options\n  this.xhr_ = this.createXhr();\n  this.xhrOptions_ = this.xmlHttpFactory_ ? this.xmlHttpFactory_.getOptions() :\n                                            goog.net.XmlHttp.getOptions();\n\n  // Set up the onreadystatechange callback\n  this.xhr_.onreadystatechange = goog.bind(this.onReadyStateChange_, this);\n\n  // Set up upload/download progress events, if progress events are supported.\n  if (this.getProgressEventsEnabled() && 'onprogress' in this.xhr_) {\n    this.xhr_.onprogress = goog.bind(function(e) {\n      'use strict';\n      this.onProgressHandler_(e, true);\n    }, this);\n    if (this.xhr_.upload) {\n      this.xhr_.upload.onprogress = goog.bind(this.onProgressHandler_, this);\n    }\n  }\n\n  /**\n   * Try to open the XMLHttpRequest (always async), if an error occurs here it\n   * is generally permission denied\n   */\n  try {\n    goog.log.fine(this.logger_, this.formatMsg_('Opening Xhr'));\n    this.inOpen_ = true;\n    this.xhr_.open(method, String(url), true);  // Always async!\n    this.inOpen_ = false;\n  } catch (err) {\n    goog.log.fine(\n        this.logger_, this.formatMsg_('Error opening Xhr: ' + err.message));\n    this.error_(goog.net.ErrorCode.EXCEPTION, err);\n    return;\n  }\n\n  // We can't use null since this won't allow requests with form data to have a\n  // content length specified which will cause some proxies to return a 411\n  // error.\n  const content = opt_content || '';\n\n  const headers = new Map(this.headers);\n\n  // Add headers specific to this request\n  if (opt_headers) {\n    if (Object.getPrototypeOf(opt_headers) === Object.prototype) {\n      for (let key in opt_headers) {\n        headers.set(key, opt_headers[key]);\n      }\n    } else if (\n        typeof opt_headers.keys === 'function' &&\n        typeof opt_headers.get === 'function') {\n      for (const key of opt_headers.keys()) {\n        headers.set(key, opt_headers.get(key));\n      }\n    } else {\n      throw new Error(\n          'Unknown input type for opt_headers: ' + String(opt_headers));\n    }\n  }\n\n  // Find whether a content type header is set, ignoring case.\n  // HTTP header names are case-insensitive.  See:\n  // http://www.w3.org/Protocols/rfc2616/rfc2616-sec4.html#sec4.2\n  const contentTypeKey =\n      Array.from(headers.keys())\n          .find(\n              header => goog.string.caseInsensitiveEquals(\n                  goog.net.XhrIo.CONTENT_TYPE_HEADER, header));\n\n  const contentIsFormData =\n      (goog.global['FormData'] && (content instanceof goog.global['FormData']));\n  if (goog.array.contains(goog.net.XhrIo.METHODS_WITH_FORM_DATA, method) &&\n      !contentTypeKey && !contentIsFormData) {\n    // For requests typically with form data, default to the url-encoded form\n    // content type unless this is a FormData request.  For FormData,\n    // the browser will automatically add a multipart/form-data content type\n    // with an appropriate multipart boundary.\n    headers.set(\n        goog.net.XhrIo.CONTENT_TYPE_HEADER, goog.net.XhrIo.FORM_CONTENT_TYPE);\n  }\n\n  // Add the headers to the Xhr object\n  for (const [key, value] of headers) {\n    this.xhr_.setRequestHeader(key, value);\n  }\n\n  if (this.responseType_) {\n    this.xhr_.responseType = this.responseType_;\n  }\n  // Set xhr_.withCredentials only when the value is different, or else in\n  // synchronous XMLHtppRequest.open Firefox will throw an exception.\n  // https://bugzilla.mozilla.org/show_bug.cgi?id=736340\n  if ('withCredentials' in this.xhr_ &&\n      this.xhr_.withCredentials !== this.withCredentials_) {\n    this.xhr_.withCredentials = this.withCredentials_;\n  }\n\n  if ('setTrustToken' in this.xhr_ && this.trustToken_) {\n    try {\n      this.xhr_.setTrustToken(this.trustToken_);\n    } catch (err) {\n      goog.log.fine(\n          this.logger_, this.formatMsg_('Error SetTrustToken: ' + err.message));\n    }\n  }\n  /**\n   * Try to send the request, or other wise report an error (404 not found).\n   */\n  try {\n    this.cleanUpTimeoutTimer_();  // Paranoid, should never be running.\n    if (this.timeoutInterval_ > 0) {\n      this.useXhr2Timeout_ = goog.net.XhrIo.shouldUseXhr2Timeout_(this.xhr_);\n      goog.log.fine(\n          this.logger_,\n          this.formatMsg_(\n              'Will abort after ' + this.timeoutInterval_ +\n              'ms if incomplete, xhr2 ' + this.useXhr2Timeout_));\n      if (this.useXhr2Timeout_) {\n        this.xhr_[goog.net.XhrIo.XHR2_TIMEOUT_] = this.timeoutInterval_;\n        this.xhr_[goog.net.XhrIo.XHR2_ON_TIMEOUT_] =\n            goog.bind(this.timeout_, this);\n      } else {\n        this.timeoutId_ =\n            goog.Timer.callOnce(this.timeout_, this.timeoutInterval_, this);\n      }\n    }\n    goog.log.fine(this.logger_, this.formatMsg_('Sending request'));\n    this.inSend_ = true;\n    this.xhr_.send(content);\n    this.inSend_ = false;\n\n  } catch (err) {\n    goog.log.fine(this.logger_, this.formatMsg_('Send error: ' + err.message));\n    this.error_(goog.net.ErrorCode.EXCEPTION, err);\n  }\n};\n\n\n/**\n * Determines if the argument is an XMLHttpRequest that supports the level 2\n * timeout value and event.\n *\n * Currently, FF 21.0 OS X has the fields but won't actually call the timeout\n * handler.  Perhaps the confusion in the bug referenced below hasn't\n * entirely been resolved.\n *\n * @see http://www.w3.org/TR/XMLHttpRequest/#the-timeout-attribute\n * @see https://bugzilla.mozilla.org/show_bug.cgi?id=525816\n *\n * @param {!goog.net.XhrLike.OrNative} xhr The request.\n * @return {boolean} True if the request supports level 2 timeout.\n * @private\n */\ngoog.net.XhrIo.shouldUseXhr2Timeout_ = function(xhr) {\n  'use strict';\n  return goog.userAgent.IE && goog.userAgent.isVersionOrHigher(9) &&\n      typeof xhr[goog.net.XhrIo.XHR2_TIMEOUT_] === 'number' &&\n      xhr[goog.net.XhrIo.XHR2_ON_TIMEOUT_] !== undefined;\n};\n\n\n/**\n * Creates a new XHR object.\n * @return {!goog.net.XhrLike.OrNative} The newly created XHR object.\n * @protected\n */\ngoog.net.XhrIo.prototype.createXhr = function() {\n  'use strict';\n  return this.xmlHttpFactory_ ? this.xmlHttpFactory_.createInstance() :\n                                goog.net.XmlHttp();\n};\n\n\n/**\n * The request didn't complete after {@link goog.net.XhrIo#timeoutInterval_}\n * milliseconds; raises a {@link goog.net.EventType.TIMEOUT} event and aborts\n * the request.\n * @private\n */\ngoog.net.XhrIo.prototype.timeout_ = function() {\n  'use strict';\n  if (typeof goog == 'undefined') {\n    // If goog is undefined then the callback has occurred as the application\n    // is unloading and will error.  Thus we let it silently fail.\n  } else if (this.xhr_) {\n    this.lastError_ =\n        'Timed out after ' + this.timeoutInterval_ + 'ms, aborting';\n    this.lastErrorCode_ = goog.net.ErrorCode.TIMEOUT;\n    goog.log.fine(this.logger_, this.formatMsg_(this.lastError_));\n    this.dispatchEvent(goog.net.EventType.TIMEOUT);\n    this.abort(goog.net.ErrorCode.TIMEOUT);\n  }\n};\n\n\n/**\n * Something errorred, so inactivate, fire error callback and clean up\n * @param {goog.net.ErrorCode} errorCode The error code.\n * @param {Error} err The error object.\n * @private\n */\ngoog.net.XhrIo.prototype.error_ = function(errorCode, err) {\n  'use strict';\n  this.active_ = false;\n  if (this.xhr_) {\n    this.inAbort_ = true;\n    this.xhr_.abort();  // Ensures XHR isn't hung (FF)\n    this.inAbort_ = false;\n  }\n  this.lastError_ = err;\n  this.lastErrorCode_ = errorCode;\n  this.dispatchErrors_();\n  this.cleanUpXhr_();\n};\n\n\n/**\n * Dispatches COMPLETE and ERROR in case of an error. This ensures that we do\n * not dispatch multiple error events.\n * @private\n */\ngoog.net.XhrIo.prototype.dispatchErrors_ = function() {\n  'use strict';\n  if (!this.errorDispatched_) {\n    this.errorDispatched_ = true;\n    this.dispatchEvent(goog.net.EventType.COMPLETE);\n    this.dispatchEvent(goog.net.EventType.ERROR);\n  }\n};\n\n\n/**\n * Abort the current XMLHttpRequest\n * @param {goog.net.ErrorCode=} opt_failureCode Optional error code to use -\n *     defaults to ABORT.\n */\ngoog.net.XhrIo.prototype.abort = function(opt_failureCode) {\n  'use strict';\n  if (this.xhr_ && this.active_) {\n    goog.log.fine(this.logger_, this.formatMsg_('Aborting'));\n    this.active_ = false;\n    this.inAbort_ = true;\n    this.xhr_.abort();\n    this.inAbort_ = false;\n    this.lastErrorCode_ = opt_failureCode || goog.net.ErrorCode.ABORT;\n    this.dispatchEvent(goog.net.EventType.COMPLETE);\n    this.dispatchEvent(goog.net.EventType.ABORT);\n    this.cleanUpXhr_();\n  }\n};\n\n\n/**\n * Nullifies all callbacks to reduce risks of leaks.\n * @override\n * @protected\n */\ngoog.net.XhrIo.prototype.disposeInternal = function() {\n  'use strict';\n  if (this.xhr_) {\n    // We explicitly do not call xhr_.abort() unless active_ is still true.\n    // This is to avoid unnecessarily aborting a successful request when\n    // dispose() is called in a callback triggered by a complete response, but\n    // in which browser cleanup has not yet finished.\n    // (See http://b/issue?id=1684217.)\n    if (this.active_) {\n      this.active_ = false;\n      this.inAbort_ = true;\n      this.xhr_.abort();\n      this.inAbort_ = false;\n    }\n    this.cleanUpXhr_(true);\n  }\n\n  XhrIo.base(this, 'disposeInternal');\n};\n\n\n/**\n * Internal handler for the XHR object's readystatechange event.  This method\n * checks the status and the readystate and fires the correct callbacks.\n * If the request has ended, the handlers are cleaned up and the XHR object is\n * nullified.\n * @private\n */\ngoog.net.XhrIo.prototype.onReadyStateChange_ = function() {\n  'use strict';\n  if (this.isDisposed()) {\n    // This method is the target of an untracked goog.Timer.callOnce().\n    return;\n  }\n  if (!this.inOpen_ && !this.inSend_ && !this.inAbort_) {\n    // Were not being called from within a call to this.xhr_.send\n    // this.xhr_.abort, or this.xhr_.open, so this is an entry point\n    this.onReadyStateChangeEntryPoint_();\n  } else {\n    this.onReadyStateChangeHelper_();\n  }\n};\n\n\n/**\n * Used to protect the onreadystatechange handler entry point.  Necessary\n * as {#onReadyStateChange_} maybe called from within send or abort, this\n * method is only called when {#onReadyStateChange_} is called as an\n * entry point.\n * {@see #protectEntryPoints}\n * @private\n */\ngoog.net.XhrIo.prototype.onReadyStateChangeEntryPoint_ = function() {\n  'use strict';\n  this.onReadyStateChangeHelper_();\n};\n\n\n/**\n * Helper for {@link #onReadyStateChange_}.  This is used so that\n * entry point calls to {@link #onReadyStateChange_} can be routed through\n * {@link #onReadyStateChangeEntryPoint_}.\n * @private\n */\ngoog.net.XhrIo.prototype.onReadyStateChangeHelper_ = function() {\n  'use strict';\n  if (!this.active_) {\n    // can get called inside abort call\n    return;\n  }\n\n  if (typeof goog == 'undefined') {\n    // NOTE(user): If goog is undefined then the callback has occurred as the\n    // application is unloading and will error.  Thus we let it silently fail.\n\n  } else if (\n      this.xhrOptions_[goog.net.XmlHttp.OptionType.LOCAL_REQUEST_ERROR] &&\n      this.getReadyState() == goog.net.XmlHttp.ReadyState.COMPLETE &&\n      this.getStatus() == 2) {\n    // NOTE(user): In IE if send() errors on a *local* request the readystate\n    // is still changed to COMPLETE.  We need to ignore it and allow the\n    // try/catch around send() to pick up the error.\n    goog.log.fine(\n        this.logger_,\n        this.formatMsg_('Local request error detected and ignored'));\n\n  } else {\n    // In IE when the response has been cached we sometimes get the callback\n    // from inside the send call and this usually breaks code that assumes that\n    // XhrIo is asynchronous.  If that is the case we delay the callback\n    // using a timer.\n    if (this.inSend_ &&\n        this.getReadyState() == goog.net.XmlHttp.ReadyState.COMPLETE) {\n      goog.Timer.callOnce(this.onReadyStateChange_, 0, this);\n      return;\n    }\n\n    this.dispatchEvent(goog.net.EventType.READY_STATE_CHANGE);\n\n    // readyState indicates the transfer has finished\n    if (this.isComplete()) {\n      goog.log.fine(this.logger_, this.formatMsg_('Request complete'));\n\n      this.active_ = false;\n\n      try {\n        // Call the specific callbacks for success or failure. Only call the\n        // success if the status is 200 (HTTP_OK) or 304 (HTTP_CACHED)\n        if (this.isSuccess()) {\n          this.dispatchEvent(goog.net.EventType.COMPLETE);\n          this.dispatchEvent(goog.net.EventType.SUCCESS);\n        } else {\n          this.lastErrorCode_ = goog.net.ErrorCode.HTTP_ERROR;\n          this.lastError_ =\n              this.getStatusText() + ' [' + this.getStatus() + ']';\n          this.dispatchErrors_();\n        }\n      } finally {\n        this.cleanUpXhr_();\n      }\n    }\n  }\n};\n\n\n/**\n * Internal handler for the XHR object's onprogress event. Fires both a generic\n * PROGRESS event and either a DOWNLOAD_PROGRESS or UPLOAD_PROGRESS event to\n * allow specific binding for each XHR progress event.\n * @param {!ProgressEvent} e XHR progress event.\n * @param {boolean=} opt_isDownload Whether the current progress event is from a\n *     download. Used to determine whether DOWNLOAD_PROGRESS or UPLOAD_PROGRESS\n *     event should be dispatched.\n * @private\n */\ngoog.net.XhrIo.prototype.onProgressHandler_ = function(e, opt_isDownload) {\n  'use strict';\n  goog.asserts.assert(\n      e.type === goog.net.EventType.PROGRESS,\n      'goog.net.EventType.PROGRESS is of the same type as raw XHR progress.');\n  this.dispatchEvent(\n      goog.net.XhrIo.buildProgressEvent_(e, goog.net.EventType.PROGRESS));\n  this.dispatchEvent(goog.net.XhrIo.buildProgressEvent_(\n      e,\n      opt_isDownload ? goog.net.EventType.DOWNLOAD_PROGRESS :\n                       goog.net.EventType.UPLOAD_PROGRESS));\n};\n\n\n/**\n * Creates a representation of the native ProgressEvent. IE doesn't support\n * constructing ProgressEvent via \"new\", and the alternatives (e.g.,\n * ProgressEvent.initProgressEvent) are non-standard or deprecated.\n * @param {!ProgressEvent} e XHR progress event.\n * @param {!goog.net.EventType} eventType The type of the event.\n * @return {!ProgressEvent} The progress event.\n * @private\n */\ngoog.net.XhrIo.buildProgressEvent_ = function(e, eventType) {\n  'use strict';\n  return /** @type {!ProgressEvent} */ ({\n    type: eventType,\n    lengthComputable: e.lengthComputable,\n    loaded: e.loaded,\n    total: e.total,\n  });\n};\n\n\n/**\n * Remove the listener to protect against leaks, and nullify the XMLHttpRequest\n * object.\n * @param {boolean=} opt_fromDispose If this is from the dispose (don't want to\n *     fire any events).\n * @private\n */\ngoog.net.XhrIo.prototype.cleanUpXhr_ = function(opt_fromDispose) {\n  'use strict';\n  if (this.xhr_) {\n    // Cancel any pending timeout event handler.\n    this.cleanUpTimeoutTimer_();\n\n    // Save reference so we can mark it as closed after the READY event.  The\n    // READY event may trigger another request, thus we must nullify this.xhr_\n    const xhr = this.xhr_;\n    const clearedOnReadyStateChange =\n        this.xhrOptions_[goog.net.XmlHttp.OptionType.USE_NULL_FUNCTION] ?\n        goog.nullFunction :\n        null;\n    this.xhr_ = null;\n    this.xhrOptions_ = null;\n\n    if (!opt_fromDispose) {\n      this.dispatchEvent(goog.net.EventType.READY);\n    }\n\n    try {\n      // NOTE(user): Not nullifying in FireFox can still leak if the callbacks\n      // are defined in the same scope as the instance of XhrIo. But, IE doesn't\n      // allow you to set the onreadystatechange to NULL so nullFunction is\n      // used.\n      xhr.onreadystatechange = clearedOnReadyStateChange;\n    } catch (e) {\n      // This seems to occur with a Gears HTTP request. Delayed the setting of\n      // this onreadystatechange until after READY is sent out and catching the\n      // error to see if we can track down the problem.\n      goog.log.error(\n          this.logger_,\n          'Problem encountered resetting onreadystatechange: ' + e.message);\n    }\n  }\n};\n\n\n/**\n * Make sure the timeout timer isn't running.\n * @private\n */\ngoog.net.XhrIo.prototype.cleanUpTimeoutTimer_ = function() {\n  'use strict';\n  if (this.xhr_ && this.useXhr2Timeout_) {\n    this.xhr_[goog.net.XhrIo.XHR2_ON_TIMEOUT_] = null;\n  }\n  if (this.timeoutId_) {\n    goog.Timer.clear(this.timeoutId_);\n    this.timeoutId_ = null;\n  }\n};\n\n\n/**\n * @return {boolean} Whether there is an active request.\n */\ngoog.net.XhrIo.prototype.isActive = function() {\n  'use strict';\n  return !!this.xhr_;\n};\n\n\n/**\n * @return {boolean} Whether the request has completed.\n */\ngoog.net.XhrIo.prototype.isComplete = function() {\n  'use strict';\n  return this.getReadyState() == goog.net.XmlHttp.ReadyState.COMPLETE;\n};\n\n\n/**\n * @return {boolean} Whether the request completed with a success.\n */\ngoog.net.XhrIo.prototype.isSuccess = function() {\n  'use strict';\n  const status = this.getStatus();\n  // A zero status code is considered successful for local files.\n  return goog.net.HttpStatus.isSuccess(status) ||\n      status === 0 && !this.isLastUriEffectiveSchemeHttp_();\n};\n\n\n/**\n * @return {boolean} whether the effective scheme of the last URI that was\n *     fetched was 'http' or 'https'.\n * @private\n */\ngoog.net.XhrIo.prototype.isLastUriEffectiveSchemeHttp_ = function() {\n  'use strict';\n  const scheme = goog.uri.utils.getEffectiveScheme(String(this.lastUri_));\n  return HTTP_SCHEME_PATTERN.test(scheme);\n};\n\n\n/**\n * Get the readystate from the Xhr object\n * Will only return correct result when called from the context of a callback\n * @return {goog.net.XmlHttp.ReadyState} goog.net.XmlHttp.ReadyState.*.\n */\ngoog.net.XhrIo.prototype.getReadyState = function() {\n  'use strict';\n  return this.xhr_ ?\n      /** @type {goog.net.XmlHttp.ReadyState} */ (this.xhr_.readyState) :\n      goog.net.XmlHttp.ReadyState.UNINITIALIZED;\n};\n\n\n/**\n * Get the status from the Xhr object\n * Will only return correct result when called from the context of a callback\n * @return {number} Http status.\n */\ngoog.net.XhrIo.prototype.getStatus = function() {\n  'use strict';\n  /**\n   * IE doesn't like you checking status until the readystate is greater than 2\n   * (i.e. it is receiving or complete).  The try/catch is used for when the\n   * page is unloading and an ERROR_NOT_AVAILABLE may occur when accessing xhr_.\n   */\n  try {\n    return this.getReadyState() > goog.net.XmlHttp.ReadyState.LOADED ?\n        this.xhr_.status :\n        -1;\n  } catch (e) {\n    return -1;\n  }\n};\n\n\n/**\n * Get the status text from the Xhr object\n * Will only return correct result when called from the context of a callback\n * @return {string} Status text.\n */\ngoog.net.XhrIo.prototype.getStatusText = function() {\n  'use strict';\n  /**\n   * IE doesn't like you checking status until the readystate is greater than 2\n   * (i.e. it is receiving or complete).  The try/catch is used for when the\n   * page is unloading and an ERROR_NOT_AVAILABLE may occur when accessing xhr_.\n   */\n  try {\n    return this.getReadyState() > goog.net.XmlHttp.ReadyState.LOADED ?\n        this.xhr_.statusText :\n        '';\n  } catch (e) {\n    goog.log.fine(this.logger_, 'Can not get status: ' + e.message);\n    return '';\n  }\n};\n\n\n/**\n * Get the last Uri that was requested\n * @return {string} Last Uri.\n */\ngoog.net.XhrIo.prototype.getLastUri = function() {\n  'use strict';\n  return String(this.lastUri_);\n};\n\n\n/**\n * Get the response text from the Xhr object\n * Will only return correct result when called from the context of a callback.\n * @return {string} Result from the server, or '' if no result available.\n */\ngoog.net.XhrIo.prototype.getResponseText = function() {\n  'use strict';\n  try {\n    return this.xhr_ ? this.xhr_.responseText : '';\n  } catch (e) {\n    // http://www.w3.org/TR/XMLHttpRequest/#the-responsetext-attribute\n    // states that responseText should return '' (and responseXML null)\n    // when the state is not LOADING or DONE. Instead, IE can\n    // throw unexpected exceptions, for example when a request is aborted\n    // or no data is available yet.\n    goog.log.fine(this.logger_, 'Can not get responseText: ' + e.message);\n    return '';\n  }\n};\n\n\n/**\n * Get the response body from the Xhr object. This property is only available\n * in IE since version 7 according to MSDN:\n * http://msdn.microsoft.com/en-us/library/ie/ms534368(v=vs.85).aspx\n * Will only return correct result when called from the context of a callback.\n *\n * One option is to construct a VBArray from the returned object and convert\n * it to a JavaScript array using the toArray method:\n * `(new window['VBArray'](xhrIo.getResponseBody())).toArray()`\n * This will result in an array of numbers in the range of [0..255]\n *\n * Another option is to use the VBScript CStr method to convert it into a\n * string as outlined in http://stackoverflow.com/questions/1919972\n *\n * @return {Object} Binary result from the server or null if not available.\n */\ngoog.net.XhrIo.prototype.getResponseBody = function() {\n  'use strict';\n  try {\n    if (this.xhr_ && 'responseBody' in this.xhr_) {\n      return this.xhr_['responseBody'];\n    }\n  } catch (e) {\n    // IE can throw unexpected exceptions, for example when a request is aborted\n    // or no data is yet available.\n    goog.log.fine(this.logger_, 'Can not get responseBody: ' + e.message);\n  }\n  return null;\n};\n\n\n/**\n * Get the response XML from the Xhr object\n * Will only return correct result when called from the context of a callback.\n * @return {Document} The DOM Document representing the XML file, or null\n * if no result available.\n */\ngoog.net.XhrIo.prototype.getResponseXml = function() {\n  'use strict';\n  try {\n    return this.xhr_ ? this.xhr_.responseXML : null;\n  } catch (e) {\n    goog.log.fine(this.logger_, 'Can not get responseXML: ' + e.message);\n    return null;\n  }\n};\n\n\n/**\n * Get the response and evaluates it as JSON from the Xhr object\n * Will only return correct result when called from the context of a callback\n * @param {string=} opt_xssiPrefix Optional XSSI prefix string to use for\n *     stripping of the response before parsing. This needs to be set only if\n *     your backend server prepends the same prefix string to the JSON response.\n * @throws Error if the response text is invalid JSON.\n * @return {Object|undefined} JavaScript object.\n */\ngoog.net.XhrIo.prototype.getResponseJson = function(opt_xssiPrefix) {\n  'use strict';\n  if (!this.xhr_) {\n    return undefined;\n  }\n\n  let responseText = this.xhr_.responseText;\n  if (opt_xssiPrefix && responseText.indexOf(opt_xssiPrefix) == 0) {\n    responseText = responseText.substring(opt_xssiPrefix.length);\n  }\n\n  return goog.json.hybrid.parse(responseText);\n};\n\n\n/**\n * Get the response as the type specificed by {@link #setResponseType}. At time\n * of writing, this is only directly supported in very recent versions of WebKit\n * (10.0.612.1 dev and later). If the field is not supported directly, we will\n * try to emulate it.\n *\n * Emulating the response means following the rules laid out at\n * http://www.w3.org/TR/XMLHttpRequest/#the-response-attribute\n *\n * On browsers with no support for this (Chrome < 10, Firefox < 4, etc), only\n * response types of DEFAULT or TEXT may be used, and the response returned will\n * be the text response.\n *\n * On browsers with Mozilla's draft support for array buffers (Firefox 4, 5),\n * only response types of DEFAULT, TEXT, and ARRAY_BUFFER may be used, and the\n * response returned will be either the text response or the Mozilla\n * implementation of the array buffer response.\n *\n * On browsers will full support, any valid response type supported by the\n * browser may be used, and the response provided by the browser will be\n * returned.\n *\n * @return {*} The response.\n */\ngoog.net.XhrIo.prototype.getResponse = function() {\n  'use strict';\n  try {\n    if (!this.xhr_) {\n      return null;\n    }\n    if ('response' in this.xhr_) {\n      return this.xhr_.response;\n    }\n    switch (this.responseType_) {\n      case ResponseType.DEFAULT:\n      case ResponseType.TEXT:\n        return this.xhr_.responseText;\n      // DOCUMENT and BLOB don't need to be handled here because they are\n      // introduced in the same spec that adds the .response field, and would\n      // have been caught above.\n      // ARRAY_BUFFER needs an implementation for Firefox 4, where it was\n      // implemented using a draft spec rather than the final spec.\n      case ResponseType.ARRAY_BUFFER:\n        if ('mozResponseArrayBuffer' in this.xhr_) {\n          return this.xhr_.mozResponseArrayBuffer;\n        }\n    }\n    // Fell through to a response type that is not supported on this browser.\n    goog.log.error(\n        this.logger_,\n        'Response type ' + this.responseType_ + ' is not ' +\n            'supported on this browser');\n    return null;\n  } catch (e) {\n    goog.log.fine(this.logger_, 'Can not get response: ' + e.message);\n    return null;\n  }\n};\n\n\n/**\n * Get the value of the response-header with the given name from the Xhr object\n * Will only return correct result when called from the context of a callback\n * and the request has completed\n * @param {string} key The name of the response-header to retrieve.\n * @return {string|undefined} The value of the response-header named key.\n */\ngoog.net.XhrIo.prototype.getResponseHeader = function(key) {\n  'use strict';\n  if (!this.xhr_ || !this.isComplete()) {\n    return undefined;\n  }\n\n  const value = this.xhr_.getResponseHeader(key);\n  return value === null ? undefined : value;\n};\n\n\n/**\n * Gets the text of all the headers in the response.\n * Will only return correct result when called from the context of a callback\n * and the request has completed.\n * @return {string} The value of the response headers or empty string.\n */\ngoog.net.XhrIo.prototype.getAllResponseHeaders = function() {\n  'use strict';\n  // getAllResponseHeaders can return null if no response has been received,\n  // ensure we always return an empty string.\n  return this.xhr_ && this.isComplete() ?\n      (this.xhr_.getAllResponseHeaders() || '') :\n      '';\n};\n\n\n/**\n * Returns all response headers as a key-value map.\n * Multiple values for the same header key can be combined into one,\n * separated by a comma and a space.\n * Note that the native getResponseHeader method for retrieving a single header\n * does a case insensitive match on the header name. This method does not\n * include any case normalization logic, it will just return a key-value\n * representation of the headers.\n * See: http://www.w3.org/TR/XMLHttpRequest/#the-getresponseheader()-method\n * @return {!Object<string, string>} An object with the header keys as keys\n *     and header values as values.\n */\ngoog.net.XhrIo.prototype.getResponseHeaders = function() {\n  'use strict';\n  // TODO(user): Make this function parse headers as per the spec\n  // (https://tools.ietf.org/html/rfc2616#section-4.2).\n\n  const headersObject = {};\n  const headersArray = this.getAllResponseHeaders().split('\\r\\n');\n  for (let i = 0; i < headersArray.length; i++) {\n    if (goog.string.isEmptyOrWhitespace(headersArray[i])) {\n      continue;\n    }\n    const keyValue =\n        goog.string.splitLimit(headersArray[i], ':', /* maxSplitCount= */ 1);\n    const key = keyValue[0];\n    let value = keyValue[1];\n\n    if (typeof value !== 'string') {\n      // There must be a value but it can be the empty string.\n      continue;\n    }\n\n    // Whitespace at the start and end of the value is meaningless.\n    value = value.trim();\n    // The key should not contain whitespace but we currently ignore that.\n\n    const values = headersObject[key] || [];\n    headersObject[key] = values;\n    values.push(value);\n  }\n\n  return goog.object.map(headersObject, function(values) {\n    'use strict';\n    return values.join(', ');\n  });\n};\n\n\n/**\n * Get the value of the response-header with the given name from the Xhr object.\n * As opposed to {@link #getResponseHeader}, this method does not require that\n * the request has completed.\n * @param {string} key The name of the response-header to retrieve.\n * @return {?string} The value of the response-header, or null if it is\n *     unavailable.\n */\ngoog.net.XhrIo.prototype.getStreamingResponseHeader = function(key) {\n  'use strict';\n  return this.xhr_ ? this.xhr_.getResponseHeader(key) : null;\n};\n\n\n/**\n * Gets the text of all the headers in the response. As opposed to\n * {@link #getAllResponseHeaders}, this method does not require that the request\n * has completed.\n * @return {string} The value of the response headers or empty string.\n */\ngoog.net.XhrIo.prototype.getAllStreamingResponseHeaders = function() {\n  'use strict';\n  return this.xhr_ ? this.xhr_.getAllResponseHeaders() : '';\n};\n\n\n/**\n * Get the last error message\n * @return {!goog.net.ErrorCode} Last error code.\n */\ngoog.net.XhrIo.prototype.getLastErrorCode = function() {\n  'use strict';\n  return this.lastErrorCode_;\n};\n\n\n/**\n * Get the last error message\n * @return {string} Last error message.\n */\ngoog.net.XhrIo.prototype.getLastError = function() {\n  'use strict';\n  return typeof this.lastError_ === 'string' ? this.lastError_ :\n                                               String(this.lastError_);\n};\n\n\n/**\n * Adds the last method, status and URI to the message.  This is used to add\n * this information to the logging calls.\n * @param {string} msg The message text that we want to add the extra text to.\n * @return {string} The message with the extra text appended.\n * @private\n */\ngoog.net.XhrIo.prototype.formatMsg_ = function(msg) {\n  'use strict';\n  return msg + ' [' + this.lastMethod_ + ' ' + this.lastUri_ + ' ' +\n      this.getStatus() + ']';\n};\n\n\n// Register the xhr handler as an entry point, so that\n// it can be monitored for exception handling, etc.\ngoog.debug.entryPointRegistry.register(\n    /**\n     * @param {function(!Function): !Function} transformer The transforming\n     *     function.\n     */\n    function(transformer) {\n      'use strict';\n      goog.net.XhrIo.prototype.onReadyStateChangeEntryPoint_ =\n          transformer(goog.net.XhrIo.prototype.onReadyStateChangeEntryPoint_);\n    });\n});  // goog.scope\n"],
"names":["goog","provide","require","requireType","scope","net","XhrIo","goog.net.XhrIo","opt_xmlHttpFactory","base","headers","Map","xmlHttpFactory_","active_","xhr_","xhrOptions_","lastUri_","lastMethod_","lastErrorCode_","ErrorCode","NO_ERROR","lastError_","errorDispatched_","inSend_","inOpen_","inAbort_","timeoutInterval_","timeoutId_","responseType_","ResponseType","DEFAULT","withCredentials_","progressEventsEnabled_","useXhr2Timeout_","trustToken_","inherits","events","EventTarget","TEXT","DOCUMENT","BLOB","ARRAY_BUFFER","prototype","logger_","log","getLogger","CONTENT_TYPE_HEADER","CONTENT_TRANSFER_ENCODING","HTTP_SCHEME_PATTERN","METHODS_WITH_FORM_DATA","FORM_CONTENT_TYPE","XHR2_TIMEOUT_","XHR2_ON_TIMEOUT_","sendInstances_","send","goog.net.XhrIo.send","url","opt_callback","opt_method","opt_content","opt_headers","opt_timeoutInterval","opt_withCredentials","x","push","listen","EventType","COMPLETE","listenOnce","READY","cleanupSend_","setTimeoutInterval","setWithCredentials","cleanup","goog.net.XhrIo.cleanup","instances","length","pop","dispose","protectEntryPoints","goog.net.XhrIo.protectEntryPoints","errorHandler","onReadyStateChangeEntryPoint_","protectEntryPoint","goog.net.XhrIo.prototype.cleanupSend_","array","remove","getTimeoutInterval","goog.net.XhrIo.prototype.getTimeoutInterval","goog.net.XhrIo.prototype.setTimeoutInterval","ms","Math","max","setResponseType","goog.net.XhrIo.prototype.setResponseType","type","getResponseType","goog.net.XhrIo.prototype.getResponseType","goog.net.XhrIo.prototype.setWithCredentials","withCredentials","getWithCredentials","goog.net.XhrIo.prototype.getWithCredentials","setProgressEventsEnabled","goog.net.XhrIo.prototype.setProgressEventsEnabled","enabled","getProgressEventsEnabled","goog.net.XhrIo.prototype.getProgressEventsEnabled","setTrustToken","goog.net.XhrIo.prototype.setTrustToken","trustToken","goog.net.XhrIo.prototype.send","Error","method","toUpperCase","createXhr","getOptions","XmlHttp","onreadystatechange","bind","onReadyStateChange_","onprogress","e","onProgressHandler_","upload","fine","formatMsg_","open","String","err","message","error_","EXCEPTION","content","Object","getPrototypeOf","key","set","keys","get","contentTypeKey","Array","from","find","header","string","caseInsensitiveEquals","contentIsFormData","global","contains","value","setRequestHeader","responseType","cleanUpTimeoutTimer_","shouldUseXhr2Timeout_","timeout_","Timer","callOnce","goog.net.XhrIo.shouldUseXhr2Timeout_","xhr","userAgent","IE","isVersionOrHigher","undefined","goog.net.XhrIo.prototype.createXhr","createInstance","goog.net.XhrIo.prototype.timeout_","TIMEOUT","dispatchEvent","abort","goog.net.XhrIo.prototype.error_","errorCode","dispatchErrors_","cleanUpXhr_","goog.net.XhrIo.prototype.dispatchErrors_","ERROR","goog.net.XhrIo.prototype.abort","opt_failureCode","ABORT","disposeInternal","goog.net.XhrIo.prototype.disposeInternal","goog.net.XhrIo.prototype.onReadyStateChange_","isDisposed","onReadyStateChangeHelper_","goog.net.XhrIo.prototype.onReadyStateChangeEntryPoint_","goog.net.XhrIo.prototype.onReadyStateChangeHelper_","OptionType","LOCAL_REQUEST_ERROR","getReadyState","ReadyState","getStatus","READY_STATE_CHANGE","isComplete","isSuccess","SUCCESS","HTTP_ERROR","getStatusText","goog.net.XhrIo.prototype.onProgressHandler_","opt_isDownload","asserts","assert","PROGRESS","buildProgressEvent_","DOWNLOAD_PROGRESS","UPLOAD_PROGRESS","goog.net.XhrIo.buildProgressEvent_","eventType","lengthComputable","loaded","total","goog.net.XhrIo.prototype.cleanUpXhr_","opt_fromDispose","clearedOnReadyStateChange","USE_NULL_FUNCTION","nullFunction","error","goog.net.XhrIo.prototype.cleanUpTimeoutTimer_","clear","isActive","goog.net.XhrIo.prototype.isActive","goog.net.XhrIo.prototype.isComplete","goog.net.XhrIo.prototype.isSuccess","status","HttpStatus","isLastUriEffectiveSchemeHttp_","goog.net.XhrIo.prototype.isLastUriEffectiveSchemeHttp_","scheme","uri","utils","getEffectiveScheme","test","goog.net.XhrIo.prototype.getReadyState","readyState","UNINITIALIZED","goog.net.XhrIo.prototype.getStatus","LOADED","goog.net.XhrIo.prototype.getStatusText","statusText","getLastUri","goog.net.XhrIo.prototype.getLastUri","getResponseText","goog.net.XhrIo.prototype.getResponseText","responseText","getResponseBody","goog.net.XhrIo.prototype.getResponseBody","getResponseXml","goog.net.XhrIo.prototype.getResponseXml","responseXML","getResponseJson","goog.net.XhrIo.prototype.getResponseJson","opt_xssiPrefix","indexOf","substring","json","hybrid","parse","getResponse","goog.net.XhrIo.prototype.getResponse","response","mozResponseArrayBuffer","getResponseHeader","goog.net.XhrIo.prototype.getResponseHeader","getAllResponseHeaders","goog.net.XhrIo.prototype.getAllResponseHeaders","getResponseHeaders","goog.net.XhrIo.prototype.getResponseHeaders","headersObject","headersArray","split","i","isEmptyOrWhitespace","keyValue","splitLimit","trim","values","object","map","join","getStreamingResponseHeader","goog.net.XhrIo.prototype.getStreamingResponseHeader","getAllStreamingResponseHeaders","goog.net.XhrIo.prototype.getAllStreamingResponseHeaders","getLastErrorCode","goog.net.XhrIo.prototype.getLastErrorCode","getLastError","goog.net.XhrIo.prototype.getLastError","goog.net.XhrIo.prototype.formatMsg_","msg","debug","entryPointRegistry","register","transformer"]
}
