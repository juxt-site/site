{"version":3,"sources":["shadow/remote/runtime/obj_support.cljc"],"mappings":"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","names":["this__5343__auto__","k__5344__auto__","this__5345__auto__","k21150","else__5346__auto__","G__21154","cljs.core/Keyword","obj","cljs.core.get","__extmap","this__5363__auto__","f__5364__auto__","init__5365__auto__","cljs.core.reduce","ret__5366__auto__","p__21163","vec__21168","k__5367__auto__","cljs.core.nth","v__5368__auto__","this__5358__auto__","writer__5359__auto__","opts__5360__auto__","pr-pair__5361__auto__","keyval__5362__auto__","cljs.core/pr-sequential-writer","cljs.core.concat","cljs.core/PersistentVector","G__21149","cljs.core/RecordIter","cljs.core/-iterator","cljs.core/nil-iter","this__5341__auto__","__meta","this__5338__auto__","__hash","this__5347__auto__","cljs.core/count","this__5339__auto__","h__5154__auto__","coll__5340__auto__","cljs.core/hash-unordered-coll","this21151","other21152","cljs.core._EQ_","this__5353__auto__","k__5354__auto__","cljs.core/contains?","cljs.core.dissoc","cljs.core/-with-meta","cljs.core.into","cljs.core/not-empty","this__5350__auto__","G__21215","this__5351__auto__","k__5352__auto__","pred__21217","cljs.core/keyword-identical?","expr__21218","cljs.core.assoc","this__5356__auto__","cljs.core/seq","cljs.core/MapEntry","this__5342__auto__","this__5348__auto__","entry__5349__auto__","cljs.core/vector?","cljs.core/-nth","cljs.core/-conj","shadow.remote.runtime.obj-support/Reference","this__5389__auto__","cljs.core/List","writer__5390__auto__","cljs.core/-write","G__21153","extmap__5385__auto__","G__21385","cljs.core/record?","shadow.remote.runtime.obj-support/->Reference","shadow.remote.runtime.obj-support/map->Reference","shadow.remote.runtime.obj-support/obj-ref","shadow.remote.runtime.obj-support/obj-ref?","result","shadow.remote.runtime.obj-support/now","js/Date.now","shadow.remote.runtime.obj-support/next-oid","cljs.core/random-uuid","shadow.remote.runtime.obj-support/register*","state","oid","obj-info","ts","obj-entry","cljs.core/assoc-in","shadow.remote.runtime.obj-support/obj-type-string","cljs.core.pr_str","cljs.core/type","js/shadow","js/shadow.remote","js/shadow.remote.runtime","js/shadow.remote.runtime.obj-support","js/shadow.remote.runtime.obj-support.make-view","method-table__5642__auto__","cljs.core.atom","prefer-table__5643__auto__","method-cache__5644__auto__","cached-hierarchy__5645__auto__","hierarchy__5646__auto__","fexpr__21389","cljs.core/MultiFn","cljs.core.symbol","shadow.remote.runtime.obj-support/make-view","p__21390","map__21391","cljs.core/--destructure-map","state-ref","view-type","msg","entry","shadow.remote.runtime.obj-support/default-max-print-size","p__21392","map__21394","shadow.remote.runtime.obj-support/as-edn","data","limit","lw","shadow.remote.runtime.writer/limit-writer","cljs.core/pr-writer","cljs.core/pr-opts","shadow.remote.runtime.writer/get-string","p__21398","map__21399","shadow.remote.runtime.obj-support/as-pprint","cljs.pprint.pprint","p__21400","map__21401","shadow.remote.runtime.obj-support/as-edn-limit","shadow.remote.runtime.writer/pr-str-limit","shadow.remote.runtime.obj-support/as-str","shadow.remote.runtime.obj-support/as-ex-str","ex","js/Error","cljs.repl/error->str","cljs.core/second","shadow.remote.runtime.obj-support/exception?","x","shadow.remote.runtime.obj-support/rank-predicates","cljs.core/nil?","cljs.core/boolean?","cljs.core/number?","cljs.core/string?","cljs.core/keyword?","cljs.core/symbol?","cljs.core/map?","cljs.core/list?","shadow.remote.runtime.obj-support/rank-val","val","cljs.core/reduce-kv","res","idx","pred","cljs.core/reduced","shadow.remote.runtime.obj-support/smart-comp","a","b","e21407","cljs.core/compare","e","ar","br","shadow.remote.runtime.obj-support/attempt-to-sort","desc","coll","e21412","cljs.core/vec","cljs.core.sort","p__21413","map__21417","shadow.remote.runtime.obj-support/browseable-kv","view-order","p__21419","map__21420","key","nav","clojure.datafy/nav","p__21421","map__21422","start","num","key-limit","val-limit","end","x__5133__auto__","y__5134__auto__","idxs","cljs.core.range","fragment","m","e21433","e21434","p__21439","map__21440","shadow.remote.runtime.obj-support/browseable-vec","p__21442","map__21443","p__21447","map__21448","p__21450","map__21451","shadow.remote.runtime.obj-support/browseable-seq","p__21452","map__21453","p__21455","map__21456","p__21458","map__21462","shadow.remote.runtime.obj-support/pageable-seq","seq-state-ref","p__21463","map__21464","cljs.core/deref","p__21470","map__21471","map__21474","vec__21475","tail","realized","seq-state","missing","next","cljs.core/first","cljs.core/rest","cljs.core.conj","cljs.core.swap_BANG_","cljs.core/assoc","p__21481","map__21482","shadow.remote.runtime.obj-support/inspect-basic","opts","e21483","cljs.core.update","cljs.core/merge","cljs.core/Symbol","cljs.core/keys","cljs.core/set?","cljs.core/seq?","shadow.remote.runtime.obj-support/inspect-type-info","shadow.remote.runtime.obj-support/inspect-source-info","cljs.core/select-keys","p__21494","map__21495","shadow.remote.runtime.obj-support/add-summary-op","summary","shadow.remote.runtime.obj-support/default-describe","o","clojure.datafy/datafy","p1__21496#","p1__21497#","p1__21498#","G__21504","cljs.core/coll?","p1__21499#","p1__21500#","shadow.remote.runtime.api/Inspectable","shadow.remote.runtime.api/describe","p__21505","map__21506","shadow.remote.runtime.obj-support/add-supports","handlers","cljs.core/set","p__21507","map__21508","shadow.remote.runtime.obj-support/ensure-descriptor","p__21511","map__21512","shadow.remote.runtime.obj-support/get-tap-history","svc","cljs.core/vals","p1__21509#","cljs.core.filter","cljs.core.get_in","p1__21510#","cljs.core.sort_by","cljs.core/reverse","cljs.core.take","cljs.core.map","p__21513","map__21514","shadow.remote.runtime.obj-support/obj-describe*","cljs.core/update-in","p__21515","p__21516","map__21517","map__21518","shadow.remote.runtime.obj-support/obj-describe","runtime","temp__5802__auto__","shadow.remote.runtime.shared/reply","p__21520","p__21521","map__21522","map__21523","shadow.remote.runtime.obj-support/obj-request","this","request-op","request-fn","cljs.core/not","e21527","new-oid","new-entry","reply-msg","G__21534","js/console.warn","G__21528","G__21529","G__21530","shadow.remote.runtime.obj-support/register","p__21535","p__21536","map__21537","map__21538","shadow.remote.runtime.obj-support/obj-forget","cljs.core/update","cljs.core/dissoc","p__21539","map__21540","shadow.remote.runtime.obj-support/obj-forget-all","shadow.remote.runtime.obj-support/basic-gc!","objs-to-drop","cljs.core.drop","shadow.remote.runtime.obj-support/start","p1__21541#","p1__21542#","p1__21543#","p1__21544#","shadow.remote.runtime.api/add-extension","p__21547","map__21548","cljs.core.merge","p__21550","map__21551","shadow.remote.runtime.obj-support/get-ref","obj-id","p__21553","map__21554","shadow.remote.runtime.obj-support/stop","shadow.remote.runtime.api/del-extension"],"sourcesContent":["(ns shadow.remote.runtime.obj-support\n  (:require\n    [clojure.datafy :as d]\n    [clojure.pprint :refer (pprint)]\n    [clojure.spec.alpha :as spec]\n    [shadow.remote.runtime.api :as p]\n    [shadow.remote.runtime.shared :as shared]\n    [shadow.remote.runtime.writer :as lw]\n    ;; FIXME: I do not like importing these here\n    ;; need to extract shadow-cljs functions if I ever move shadow.remote out\n    ;; cljs.repl has way too much other stuff on the CLJ side not error related we don't really need here\n    ;; should just have one namespace only concerned with formatting errors\n    ;; maybe even as separate plugin\n    #?@(:clj [[shadow.cljs.devtools.errors :refer (error-format)]\n              [shadow.jvm-log]]\n        :cljs [[cljs.repl :refer (error->str)]]))\n  #?(:clj (:import [java.util UUID])))\n\n(defrecord Reference [obj])\n\n(defn obj-ref [obj]\n  (when (some? obj)\n    (Reference. obj)))\n\n(defn obj-ref? [result]\n  (instance? Reference result))\n\n(defn now []\n  #?(:clj\n     (System/currentTimeMillis)\n     :cljs\n     (js/Date.now)))\n\n(defn next-oid []\n  #?(:clj\n     (str (UUID/randomUUID))\n     :cljs\n     (str (random-uuid))))\n\n(defn register*\n  [state oid obj obj-info]\n\n  (let [ts (now)\n\n        obj-entry\n        {:oid oid\n         :obj obj\n         ;; tracking that for GC purposes\n         :access-at ts\n         :obj-info (assoc obj-info :added-at ts)}]\n\n    (assoc-in state [:objects oid] obj-entry)))\n\n(declare register)\n\n(defn obj-type-string [obj]\n  (if (nil? obj)\n    \"nil\"\n    #?(:clj\n       (str (when (fn? obj) \"function: \") (-> (class obj) (.getName)))\n       :cljs\n       (pr-str (type obj)))))\n\n(defmulti make-view\n  (fn [state-ref {:keys [view-type] :as msg} entry]\n    view-type))\n\n;; 1meg?\n(def default-max-print-size (* 1 1024 1024))\n\n(defn as-edn\n  [data {:keys [limit] :or {limit default-max-print-size} :as msg}]\n  (let [lw (lw/limit-writer limit)]\n    #?(:clj\n       (print-method data lw)\n       :cljs\n       (pr-writer data lw (pr-opts)))\n    (lw/get-string lw)))\n\n(defn as-pprint\n  [data {:keys [limit] :or {limit default-max-print-size} :as msg}]\n  ;; CLJ pprint for some reason doesn't run out of memory when printing circular stuff\n  ;; but it never finishes either\n  (let [lw (lw/limit-writer limit)]\n    (pprint data lw)\n    (lw/get-string lw)))\n\n(defn as-edn-limit\n  [data {:keys [limit] :as msg}]\n  (lw/pr-str-limit data limit))\n\n;; FIXME: should likely support limit options\n(defn as-str\n  [data msg]\n  (str data))\n\n(defn as-ex-str [ex msg]\n  #?(:cljs\n     (if (instance? js/Error ex)\n       (error->str ex)\n       (str \"Execution error:\\n\"\n            ;; can be any object, really no hope in making this any kind of readable\n            ;; capping it so throwing something large doesn't blow up the REPL\n            \"  \" (second (lw/pr-str-limit ex 200)) \"\\n\"\n            \"\\n\"))\n\n     :clj\n     (error-format ex)))\n\n(defn exception? [x]\n  #?(:clj (instance? java.lang.Throwable x)\n     ;; everything can be thrown in JS\n     ;; (throw \"x\")\n     ;; (throw (js/Promise.resolved \"x\"))\n     :cljs true ;; (instance? js/Error x)\n     ))\n\n(def rank-predicates\n  [nil?\n   boolean?\n   number?\n   string?\n   keyword?\n   symbol?\n   vector?\n   map?\n   list?])\n\n(defn rank-val [val]\n  (reduce-kv\n    (fn [res idx pred]\n      (if (pred val)\n        (reduced idx)\n        res))\n    -1\n    rank-predicates))\n\n(defn smart-comp [a b]\n  (try\n    (compare a b)\n    (catch #?(:clj Exception :cljs js/Error) e\n      (let [ar (rank-val a)\n            br (rank-val b)]\n        (compare ar br)))))\n\n(defn attempt-to-sort [desc coll]\n  (try\n    (-> desc\n        (assoc :view-order (vec (sort smart-comp coll)))\n        (assoc-in [:summary :sorted] true))\n    (catch #?(:clj Exception :cljs :default) e\n      (-> desc\n          (assoc :view-order (vec coll))\n          (assoc-in [:summary :sorted] false)))))\n\n(defn browseable-kv [{:keys [view-order data] :as desc}]\n  (-> desc\n      (assoc-in [:handlers :nav]\n        (fn [{:keys [idx]}]\n          (let [key (nth view-order idx)\n                val (get data key)\n                nav (d/nav data key val)]\n            (obj-ref nav))))\n      (assoc-in [:handlers :fragment]\n        (fn [{:keys [start num key-limit val-limit]\n              :or {key-limit 100\n                   val-limit 100}\n              :as msg}]\n\n          (let [end (min (count view-order) (+ start num))\n                idxs (range start end)\n                fragment\n                (reduce\n                  (fn [m idx]\n                    (let [key (nth view-order idx)\n                          val (get data key)]\n                      (assoc m idx {:key (try\n                                           (lw/pr-str-limit key key-limit)\n                                           (catch #?(:clj Exception :cljs :default) e\n                                             [true \"... print failed ...\"]))\n                                    :val (try\n                                           (lw/pr-str-limit val val-limit)\n                                           (catch #?(:clj Exception :cljs :default) e\n                                             [true \"... print failed ...\"]))})))\n                  {}\n                  idxs)]\n\n            fragment)))))\n\n(defn browseable-vec [{:keys [data] :as desc}]\n  (-> desc\n      (assoc-in [:handlers :nav]\n        (fn [{:keys [idx]}]\n          (let [val (nth data idx)\n                nav (d/nav data idx val)]\n            (obj-ref nav))))\n      (assoc-in [:handlers :fragment]\n        (fn [{:keys [start num val-limit]\n              :or {val-limit 100}\n              :as msg}]\n\n          (let [end (min (count data) (+ start num))\n                idxs (range start end)\n                fragment\n                (reduce\n                  (fn [m idx]\n                    (let [val (nth data idx)]\n                      (assoc m idx {:val (lw/pr-str-limit val val-limit)})))\n                  {}\n                  idxs)]\n\n            fragment)))))\n\n(defn browseable-seq [{:keys [data view-order] :as desc}]\n  (-> desc\n      (assoc-in [:handlers :nav]\n        (fn [{:keys [idx]}]\n          (let [val (nth view-order idx)\n                nav (d/nav data idx val)]\n            (obj-ref nav))))\n      (assoc-in [:handlers :fragment]\n        (fn [{:keys [start num val-limit]\n              :or {val-limit 100}\n              :as msg}]\n\n          (let [end (min (count view-order) (+ start num))\n                idxs (range start end)\n                fragment\n                (reduce\n                  (fn [m idx]\n                    (let [val (nth view-order idx)]\n                      (assoc m idx {:val (lw/pr-str-limit val val-limit)})))\n                  {}\n                  idxs)]\n\n            fragment)))))\n\n(defn pageable-seq [{:keys [data] :as desc}]\n  ;; data is always beginning of seq\n  (let [seq-state-ref\n        (atom {:tail data ;; track where we are at\n               :realized []})]\n    (-> desc\n        (assoc :seq-state-ref seq-state-ref)\n        (assoc-in [:handlers :nav]\n          (fn [{:keys [idx]}]\n            ;; FIXME: should validate that idx is actually realized\n            (let [val (nth (:realized @seq-state-ref) idx)\n                  ;; FIXME: not sure there are many cases where lazy seqs actually have nav?\n                  nav (d/nav data idx val)]\n              (obj-ref nav))))\n        (assoc-in [:handlers :chunk]\n          (fn [{:keys [start num val-limit]\n                :or {val-limit 100}\n                :as msg}]\n\n            ;; need locking otherwise threads may realize more than once\n            ;; shouldn't be much of an issue but better be safe\n            (locking seq-state-ref\n              (let [{:keys [tail realized] :as seq-state} @seq-state-ref\n\n                    end (+ start num)\n                    missing (- end (count realized))\n\n                    [tail realized]\n                    (loop [tail tail\n                           realized realized\n                           missing missing]\n                      (if-not (pos? missing)\n                        [tail realized]\n                        (let [next (first tail)]\n                          (if (nil? next)\n                            [nil realized]\n                            (recur (rest tail) (conj realized next) (dec missing))))))\n\n                    idxs (range start (min end (count realized)))\n                    fragment\n                    (reduce\n                      (fn [m idx]\n                        (let [val (nth realized idx)]\n                          (assoc m idx {:val (lw/pr-str-limit val val-limit)})))\n                      {}\n                      idxs)]\n\n                (swap! seq-state-ref assoc :tail tail :realized realized)\n\n                {:start start\n                 :realized (count realized)\n                 :fragment fragment\n                 :more? (or (> (count realized) end) (some? tail))})))))))\n\n(comment\n  (def x (pageable-seq {:data (map (fn [x] (prn [:realize x]) x) (range 10))}))\n\n  (let [chunk (get-in x [:handlers :chunk])]\n    (chunk {:start 0 :num 5})\n    )\n\n  (let [chunk (get-in x [:handlers :chunk])]\n    (chunk {:start 5 :num 10})\n    ))\n\n(defn inspect-basic [{:keys [data] :as desc} obj opts]\n  (try\n    (cond\n      (nil? data)\n      (assoc-in desc [:summary :data-type] :nil)\n\n      (string? data)\n      (-> desc\n          (update :summary merge {:data-type :string\n                                  :length (count data)})\n          ;; FIXME: substring support?\n          (assoc-in [:handlers :get-value] (fn [msg] data)))\n\n      (boolean? data)\n      (-> desc\n          (assoc-in [:summary :data-type] :boolean)\n          (assoc-in [:handlers :get-value] (fn [msg] data)))\n\n      (number? data)\n      (-> desc\n          (assoc-in [:summary :data-type] :number)\n          (assoc-in [:handlers :get-value] (fn [msg] data)))\n\n      (keyword? data)\n      (-> desc\n          (assoc-in [:summary :data-type] :keyword)\n          (assoc-in [:handlers :get-value] (fn [msg] data)))\n\n      (symbol? data)\n      (-> desc\n          (assoc-in [:summary :data-type] :symbol)\n          (assoc-in [:handlers :get-value] (fn [msg] data)))\n\n      (map? data)\n      (-> desc\n          (update :summary merge {:data-type :map\n                                  :entries (count data)})\n          (attempt-to-sort (keys data))\n          (browseable-kv))\n\n      (vector? data)\n      (-> desc\n          (update :summary merge {:data-type :vec\n                                  :entries (count data)})\n          (browseable-vec))\n\n      (set? data)\n      (-> desc\n          (update :summary merge {:data-type :set\n                                  :entries (count data)})\n          (attempt-to-sort data)\n          (browseable-seq))\n\n      (list? data)\n      (-> desc\n          (update :summary merge {:data-type :list\n                                  :entries (count data)})\n          (assoc :view-order (vec data))\n          (browseable-seq))\n\n      ;; lazy seqs\n      (seq? data)\n      (-> desc\n          (update :summary merge {:data-type :lazy-seq})\n          (pageable-seq))\n\n      ;; FIXME: records?\n\n      :else\n      (assoc-in desc [:summary :data-type] :unsupported))\n\n    (catch #?(:cljs :default :clj Exception) e\n      (assoc-in desc [:summary :data-type] :unsupported))))\n\n(defn inspect-type-info [desc obj opts]\n  (assoc-in desc [:summary :obj-type] (obj-type-string obj)))\n\n(defn inspect-source-info [desc obj opts]\n  (update desc :summary merge (select-keys opts [:ns :line :column :label])))\n\n(defn add-summary-op [{:keys [summary] :as desc}]\n  (assoc-in desc [:handlers :summary] (fn [msg] summary)))\n\n(defn default-describe [o opts]\n  (let [data (d/datafy o)]\n\n    (-> {:data data\n         :summary\n         {:added-at (:added-at opts)\n          :datafied (not (identical? data o))}\n\n         ;; FIXME: should these work on the datafy result or the original?\n         ;; maybe different ops? maybe msg option?\n         :handlers\n         (-> {:str #(as-str o %)\n              ;; FIXME: only do those for actual clojure vals?\n              :edn #(as-edn o %)\n              :edn-limit #(as-edn-limit o %)}\n             (cond->\n               (or (coll? o) (seq? o))\n               (assoc :pprint #(as-pprint o %))\n\n               (exception? o)\n               (assoc :ex-str #(as-ex-str o %))\n               ))}\n\n        (inspect-basic o opts)\n        (inspect-type-info o opts)\n        (inspect-source-info o opts)\n        (add-summary-op))))\n\n(extend-protocol p/Inspectable\n  #?(:clj Object :cljs default)\n  (describe [o opts]\n    (default-describe o opts))\n\n  nil\n  (describe [o opts]\n    (default-describe o opts)))\n\n(comment\n  (p/describe\n    {:hello \"world\"}\n    {:added-at \"NOW\" :ns \"foo.bar\"}))\n\n;; called after describe so impls don't have to worry about this\n(defn add-supports [{:keys [handlers] :as desc}]\n  (assoc-in desc [:summary :supports] (set (keys handlers))))\n\n;; FIXME: this is running inside swap! which means it can potentially\n;; end up getting executed several times for the same object (in CLJ)\n;; that is not great and should be handled differently\n(defn ensure-descriptor [{:keys [obj obj-info desc] :as entry}]\n  (if desc\n    entry\n    (assoc entry :desc (-> (p/describe obj obj-info)\n                           (add-supports)))))\n\n(defn get-tap-history [{:keys [state-ref] :as svc} num]\n  (->> (:objects @state-ref)\n       (vals)\n       (filter #(= :tap (get-in % [:obj-info :from])))\n       (sort-by #(get-in % [:obj-info :added-at]))\n       (reverse)\n       (take num)\n       (map :oid)\n       (into [])))\n\n(defn obj-describe*\n  [{:keys [state-ref]}\n   oid]\n  (when (contains? (:objects @state-ref) oid)\n    (swap! state-ref update-in [:objects oid] ensure-descriptor)\n    (swap! state-ref assoc-in [:objects oid :access-at] (now))\n    (let [summary (get-in @state-ref [:objects oid :desc :summary])]\n      summary)))\n\n(defn obj-describe\n  [{:keys [runtime] :as svc}\n   {:keys [oid] :as msg}]\n  (if-let [summary (obj-describe* svc oid)]\n    (shared/reply runtime msg {:op :obj-summary\n                               :oid oid\n                               :summary summary})\n    (shared/reply runtime msg {:op :obj-not-found :oid oid})))\n\n(defn obj-request\n  [{:keys [state-ref runtime] :as this}\n   {:keys [oid request-op] :as msg}]\n  (if-not (contains? (:objects @state-ref) oid)\n    (shared/reply runtime msg {:op :obj-not-found :oid oid})\n    (do (swap! state-ref update-in [:objects oid] ensure-descriptor)\n        (swap! state-ref assoc-in [:objects oid :access-at] (now))\n        (let [entry (get-in @state-ref [:objects oid])\n              request-fn (get-in entry [:desc :handlers request-op])]\n          (if-not request-fn\n            (shared/reply runtime msg {:op :obj-request-not-supported\n                                       :oid oid\n                                       :request-op request-op})\n            (try\n              (let [result (request-fn msg)]\n\n                ;; FIXME: add support for generic async results\n                ;; all handlers should already be sync but allow async results\n                (if-not (obj-ref? result)\n                  (shared/reply runtime msg\n                    {:op :obj-result\n                     :oid oid\n                     :result result})\n\n                  (let [new-oid (next-oid)\n                        ts (now)\n\n                        new-entry\n                        {:oid new-oid\n                         :obj (:obj result)\n                         :access-at ts\n                         ;; FIXME: should keep some info on how this ref came to be\n                         :obj-info {:added-at ts\n                                    :added-via oid}}]\n\n                    (swap! state-ref assoc-in [:objects new-oid] new-entry)\n\n                    (let [reply-msg\n                          (-> {:op :obj-result-ref\n                               :oid oid\n                               :ref-oid new-oid}\n                              (cond->\n                                ;; only send new-obj :summary when requested\n                                (:summary msg)\n                                (assoc :summary (obj-describe* this new-oid))))]\n\n                      (shared/reply runtime msg reply-msg)))))\n\n              (catch #?(:clj Exception :cljs :default) e\n                #?(:cljs (js/console.warn \"action-request-action failed\" (:obj entry) e)\n                   :clj (shadow.jvm-log/warn-ex e ::obj-request-failed msg))\n                (shared/reply runtime msg\n                  {:op :obj-request-failed\n                   :oid oid\n                   :msg msg\n                   :ex-oid (register this e {:msg msg})})))))\n        )))\n\n(defn obj-forget\n  [{:keys [state-ref] :as svc}\n   {:keys [oid] :as msg}]\n  (swap! state-ref update :objects dissoc oid))\n\n(defn obj-forget-all\n  [{:keys [state-ref] :as svc}\n   msg]\n  (swap! state-ref assoc :objects {}))\n\n(defn basic-gc! [state]\n  (let [objs-to-drop\n        (->> (:objects state)\n             (vals)\n             (sort-by :access-at)\n             (reverse)\n             (drop 100) ;; FIXME: make configurable\n             (map :oid))]\n\n    (reduce\n      (fn [state oid]\n        (update state :objects dissoc oid))\n      state\n      objs-to-drop)))\n\n(defn start [runtime]\n  (let [state-ref (atom {:objects {}\n                         :id-seq-ref 0})\n\n        svc\n        {:runtime runtime\n         :state-ref state-ref}]\n\n    (p/add-extension runtime\n      ::ext\n      {:ops {:obj-describe #(obj-describe svc %)\n             :obj-request #(obj-request svc %)\n             :obj-forget #(obj-forget svc %)\n             :obj-forget-all #(obj-forget-all svc %)}\n       :on-idle #(swap! state-ref basic-gc!)})\n\n    svc))\n\n(defn register [{:keys [state-ref] :as svc} obj obj-info]\n  (let [oid (next-oid)]\n    (if-not (and (vector? obj) (= :shadow.remote/wrap (first obj)) (= (count obj) 3))\n      (swap! state-ref register* oid obj obj-info)\n      (swap! state-ref register* oid (nth obj 1) (merge obj-info (nth obj 2))))\n    oid))\n\n(defn get-ref [{:keys [state-ref]} obj-id]\n  (get-in @state-ref [:objects obj-id]))\n\n(defn stop [{:keys [runtime]}]\n  (p/del-extension runtime ::ext))\n\n(comment\n  (def obj-support (:clj-runtime-obj-support (shadow.cljs.devtools.server.runtime/get-instance)))\n  (swap! (:state-ref obj-support) assoc :objects {})\n  )"]}