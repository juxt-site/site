{"juxt/site/bootstrap"
 {:juxt.site/title "Bootstrap resources"
  :juxt.site/description "Bootstrap resources"
  :juxt.site/installers
  [{:juxt.site/base-uri "https://auth.example.org" :juxt.site/installer-path "/_site/do-operation"}
   {:juxt.site/base-uri "https://auth.example.org" :juxt.site/installer-path "/_site/subjects/system"}
   {:juxt.site/base-uri "https://auth.example.org" :juxt.site/installer-path "/_site/operations/create-operation"}
   {:juxt.site/base-uri "https://auth.example.org" :juxt.site/installer-path "/_site/permissions/system/bootstrap"}
   {:juxt.site/base-uri "https://auth.example.org" :juxt.site/installer-path "/_site/operations/grant-permission"}
   {:juxt.site/base-uri "https://auth.example.org" :juxt.site/installer-path "/_site/operations/install-not-found"}
   {:juxt.site/base-uri "https://auth.example.org" :juxt.site/installer-path "/_site/permissions/system/install-not-found"}
   {:juxt.site/base-uri "https://auth.example.org" :juxt.site/installer-path "/_site/not-found"}
   {:juxt.site/base-uri "https://data.example.org" :juxt.site/installer-path "/_site/not-found"}
   {:juxt.site/base-uri "https://auth.example.org" :juxt.site/installer-path "/_site/operations/get-not-found"}
   {:juxt.site/base-uri "https://auth.example.org" :juxt.site/installer-path "/_site/permissions/get-not-found"}
   ;; Each base-uri has a configuration, allowing us to attach meta-data to it.
   {:juxt.site/base-uri "https://auth.example.org" :juxt.site/installer-path "/_site/config"}
   {:juxt.site/base-uri "https://data.example.org" :juxt.site/installer-path "/_site/config"}

   ;; A SiteBootstrap role for allowing site-cli and insite to add users
   ;; and grant permissions.
   ;;
   ;; TODO: Could
   ;; https://auth.example.org/_site/operations/create-operation and
   ;; https://auth.example.org/_site/operations/grant-permission be
   ;; assigned to this role (and their rules changed to consider roles
   ;; as well as direct subject assignment?)

   {:juxt.site/base-uri "https://auth.example.org"
    :juxt.site/installer-path "/operations/put-role"}
   {:juxt.site/base-uri "https://auth.example.org"
    :juxt.site/installer-path "/permissions/system/put-role"}
   {:juxt.site/base-uri "https://data.example.org"
    :juxt.site/installer-path "/_site/roles/{{role}}"
    :juxt.site/parameters {"role" "SiteBootstrap"}
    :juxt.site/description "This role grants access to operations that can add users and grant permissions."}

   {:juxt.site/base-uri "https://data.example.org"
    :juxt.site/installer-path "/_site/roles/{{role}}"
    :juxt.site/parameters {"role" "SiteSystemQuery"}
    :juxt.site/description "This role grants access to operations that query sensitive system information."}

   {:juxt.site/base-uri "https://data.example.org"
    :juxt.site/installer-path "/_site/roles/{{role}}"
    :juxt.site/parameters {"role" "SiteAdmin"}
    :juxt.site/description "This role grants access to most administrative operations"}

   {:juxt.site/base-uri "https://auth.example.org"
    :juxt.site/description "Let SiteAdmin create operations"
    :juxt.site/installer-path "/_site/permissions/SiteAdmin/create-operation"}

   {:juxt.site/base-uri "https://auth.example.org"
    :juxt.site/description "Let SiteAdmin grant permission to operations"
    :juxt.site/installer-path "/_site/permissions/SiteAdmin/grant-permission"}
   ]}

 "juxt/site/bundles-api"
 {:juxt.site/title "Bundles API"
  :juxt.site/description "Bundle API"
  :juxt.site/installers
  [
   {:juxt.site/base-uri "https://auth.example.org"
    :juxt.site/installer-path "/_site/operations/get-bundle-by-id"}

   {:juxt.site/base-uri "https://auth.example.org"
    :juxt.site/description "Let SiteAdmin search for a bundle"
    :juxt.site/installer-path "/_site/permissions/SiteAdmin/get-bundle-by-id"}

   {:juxt.site/base-uri "https://auth.example.org"
    :juxt.site/installer-path "/_site/operations/delete-bundle-by-id"}

   {:juxt.site/base-uri "https://auth.example.org"
    :juxt.site/description "Let SiteAdmin search for a bundle"
    :juxt.site/installer-path "/_site/permissions/SiteAdmin/delete-bundle-by-id"}

   {:juxt.site/base-uri "https://auth.example.org"
    :juxt.site/installer-path "/_site/operations/all-bundles"}

   {:juxt.site/base-uri "https://auth.example.org"
    :juxt.site/description "Let SiteAdmin search for all bundles"
    :juxt.site/installer-path "/_site/permissions/SiteAdmin/all-bundles"}

   {:juxt.site/base-uri "https://data.example.org"
    :juxt.site/installer-path "/_site/bundles"}
   {:juxt.site/base-uri "https://data.example.org"
    :juxt.site/installer-path "/_site/bundles.txt"}
   {:juxt.site/base-uri "https://data.example.org"
    :juxt.site/installer-path "/_site/bundles.jsonlines"}]}

 "juxt/site/unprotected-resources"
 {:juxt.site/title "Unprotected resources"
  :juxt.site/installers
  [{:juxt.site/base-uri "https://auth.example.org" :juxt.site/installer-path "/permissions/get-unprotected-resource"}
   {:juxt.site/base-uri "https://auth.example.org" :juxt.site/installer-path "/operations/get-unprotected-resource"}]}

 "juxt/site/api-operations"
 {:juxt.site/title "API endpoints"
  :juxt.site/description "API endpoints"
  :juxt.site/installers
  [{:juxt.site/base-uri "https://auth.example.org"
    :juxt.site/installer-path "/operations/put-api-endpoint"}
   {:juxt.site/base-uri "https://auth.example.org"
    :juxt.site/installer-path "/permissions/system/put-api-endpoint"}
   {:juxt.site/base-uri "https://auth.example.org"
    :juxt.site/installer-path "/operations/put-resource"}
   {:juxt.site/base-uri "https://auth.example.org"
    :juxt.site/installer-path "/permissions/system/put-resource"}

   {:juxt.site/base-uri "https://auth.example.org"
    :juxt.site/installer-path "/permissions/by-role/{{role}}/{{operation}}"
    :juxt.site/parameters {"role" "SiteAdmin"
                           "operation" "put-api-endpoint"}}

   {:juxt.site/base-uri "https://auth.example.org"
    :juxt.site/installer-path "/permissions/by-role/{{role}}/{{operation}}"
    :juxt.site/parameters {"role" "SiteAdmin"
                           "operation" "put-resource"}}]}

 "juxt/site/resources-api"
 {:juxt.site/title "Resources API"
  :juxt.site/description "Resources API"
  :juxt.site/installers
  [ ;; Resources
   {:juxt.site/base-uri "https://auth.example.org"
    :juxt.site/installer-path "/operations/install-resources"}
   {:juxt.site/base-uri "https://data.example.org"
    :juxt.site/installer-path "/_site/resources"}

   ;; Permissions (mapping roles to operations)
   {:juxt.site/base-uri "https://auth.example.org"
    :juxt.site/installer-path "/permissions/by-role/{{role}}/{{operation}}"
    :juxt.site/parameters {"role" "SiteBootstrap" "operation" "install-resources"}}
   {:juxt.site/base-uri "https://auth.example.org"
    :juxt.site/installer-path "/permissions/by-role/{{role}}/{{operation}}"
    :juxt.site/parameters {"role" "SiteAdmin" "operation" "install-resources"}}]}

 "juxt/site/logs-api"
 {:juxt.site/title "Logs API"
  :juxt.site/description "Logs API"
  :juxt.site/installers
  [ ;; Endpoints
   {:juxt.site/base-uri "https://auth.example.org"
    :juxt.site/installer-path "/operations/get-logs"}
   {:juxt.site/base-uri "https://data.example.org"
    :juxt.site/installer-path "/_site/logs"}
   {:juxt.site/base-uri "https://data.example.org"
    :juxt.site/installer-path "/_site/logs.jsonlines"}
   {:juxt.site/base-uri "https://data.example.org"
    :juxt.site/installer-path "/_site/logs.txt"}
   {:juxt.site/base-uri "https://data.example.org"
    :juxt.site/installer-path "/_site/logs.json-seq"}

   ;; Permissions (mapping roles to operations)
   {:juxt.site/base-uri "https://auth.example.org"
    :juxt.site/installer-path "/permissions/by-role/{{role}}/{{operation}}"
    :juxt.site/parameters {"role" "SiteBootstrap" "operation" "get-logs"}}
   {:juxt.site/base-uri "https://auth.example.org"
    :juxt.site/installer-path "/permissions/by-role/{{role}}/{{operation}}"
    :juxt.site/parameters {"role" "SiteAdmin" "operation" "get-logs"}}]}

 "juxt/site/events-api"
 {:juxt.site/title "Events API"
  :juxt.site/description "Events API"
  :juxt.site/installers
  [ ;; Endpoints
   {:juxt.site/base-uri "https://auth.example.org"
    :juxt.site/installer-path "/operations/get-events"}
   {:juxt.site/base-uri "https://data.example.org"
    :juxt.site/installer-path "/_site/events"}
   {:juxt.site/base-uri "https://data.example.org"
    :juxt.site/installer-path "/_site/events.json"}
   {:juxt.site/base-uri "https://data.example.org"
    :juxt.site/installer-path "/_site/events.edn"}

   ;; Permissions (mapping roles to operations)
   {:juxt.site/base-uri "https://auth.example.org"
    :juxt.site/installer-path "/permissions/by-role/{{role}}/{{operation}}"
    :juxt.site/parameters {"role" "SiteBootstrap" "operation" "get-events"}}
   {:juxt.site/base-uri "https://auth.example.org"
    :juxt.site/installer-path "/permissions/by-role/{{role}}/{{operation}}"
    :juxt.site/parameters {"role" "SiteAdmin" "operation" "get-events"}}]}

 "juxt/site/endpoints-api"
 {:juxt.site/title "API introspection"
  :juxt.site/description "API introspection"
  :juxt.site/installers
  [{:juxt.site/base-uri "https://auth.example.org"
    :juxt.site/installer-path "/operations/get-api-endpoints"}
   {:juxt.site/base-uri "https://data.example.org"
    :juxt.site/installer-path "/_site/api-endpoints"}
   {:juxt.site/base-uri "https://data.example.org"
    :juxt.site/installer-path "/_site/api-endpoints.json"}
   {:juxt.site/base-uri "https://data.example.org"
    :juxt.site/installer-path "/_site/api-endpoints.edn"}
   {:juxt.site/base-uri "https://data.example.org"
    :juxt.site/installer-path "/_site/api-endpoints.csv"}
   {:juxt.site/base-uri "https://auth.example.org"
    :juxt.site/installer-path "/permissions/by-role/{{role}}/{{operation}}"
    :juxt.site/parameters {"role" "SiteAdmin"
                           "operation" "get-api-endpoints"}}
   {:juxt.site/base-uri "https://auth.example.org"
    :juxt.site/installer-path "/permissions/by-role/{{role}}/{{operation}}"
    :juxt.site/parameters {"role" "SiteSystemQuery"
                           "operation" "get-api-endpoints"}}

   ;; Not sure where this belongs!
   {:juxt.site/base-uri "https://auth.example.org"
    :juxt.site/installer-path "/permissions/by-role/{{role}}/{{operation}}"
    :juxt.site/parameters {"role" "SiteAdmin"
                           "operation" "oauth/register-scope"}}]}

 "juxt/site/openapis-api"
 {:juxt.site/title "OpenAPIs API"
  :juxt.site/description "An API to discover and install OpenAPIs"
  :juxt.site/installers
  [ ;; Openapis
   {:juxt.site/base-uri "https://auth.example.org"
    :juxt.site/installer-path "/operations/get-openapis"}
   {:juxt.site/base-uri "https://auth.example.org"
    :juxt.site/installer-path "/operations/post-openapi"}

   ;; Endpoints
   {:juxt.site/base-uri "https://data.example.org"
    :juxt.site/installer-path "/_site/openapis"}
   {:juxt.site/base-uri "https://data.example.org"
    :juxt.site/installer-path "/_site/openapis.json"}
   {:juxt.site/base-uri "https://data.example.org"
    :juxt.site/installer-path "/_site/openapis.edn"}

   ;; Permissions
   {:juxt.site/base-uri "https://auth.example.org"
    :juxt.site/installer-path "/permissions/by-role/{{role}}/{{operation}}"
    :juxt.site/parameters {"role" "SiteAdmin"
                           "operation" "put-openapi-document"}}

   ;; Used by System API
   {:juxt.site/base-uri "https://auth.example.org"
    :juxt.site/installer-path "/operations/get-openapi-document"}
   {:juxt.site/base-uri "https://auth.example.org"
    :juxt.site/installer-path "/permissions/get-openapi-document"}

   {:juxt.site/base-uri "https://auth.example.org"
    :juxt.site/installer-path "/operations/put-openapi-document"}

   {:juxt.site/base-uri "https://auth.example.org"
    :juxt.site/installer-path "/permissions/system/put-openapi-document"}

   {:juxt.site/base-uri "https://auth.example.org"
    :juxt.site/installer-path "/permissions/by-role/{{role}}/{{operation}}"
    :juxt.site/parameters {"role" "SiteAdmin"
                           "operation" "post-openapi"}}

   {:juxt.site/base-uri "https://auth.example.org"
    :juxt.site/installer-path "/permissions/by-role/{{role}}/{{operation}}"
    :juxt.site/parameters {"role" "SiteAdmin"
                           "operation" "get-openapis"}}]}

 "juxt/site/users-api"
 {:juxt.site/title "Users API"
  :juxt.site/description "Users API"
  :juxt.site/installers
  [

   ;; HTML
   {:juxt.site/base-uri "https://data.example.org"
    :juxt.site/installer-path "/_site/templates/document-base.html"}
   {:juxt.site/base-uri "https://data.example.org"
    :juxt.site/installer-path "/_site/templates/fetch-html-content.html"}

   ;; Endpoints
   {:juxt.site/base-uri "https://data.example.org"
    :juxt.site/installer-path "/_site/users"}
   {:juxt.site/base-uri "https://data.example.org"
    :juxt.site/installer-path "/_site/users.json"}
   {:juxt.site/base-uri "https://data.example.org"
    :juxt.site/installer-path "/_site/users.edn"}
   {:juxt.site/base-uri "https://data.example.org"
    :juxt.site/installer-path "/_site/users.html"}
   {:juxt.site/base-uri "https://data.example.org"
    :juxt.site/installer-path "/_site/users/{username}"}

   ;; Role assignments
   ;; SiteAdmin role
   {:juxt.site/base-uri "https://auth.example.org"
    :juxt.site/installer-path "/permissions/by-role/{{role}}/{{operation}}"
    :juxt.site/parameters {"role" "SiteAdmin"
                           "operation" "get-users"}}
   {:juxt.site/base-uri "https://auth.example.org"
    :juxt.site/installer-path "/permissions/by-role/{{role}}/{{operation}}"
    :juxt.site/parameters {"role" "SiteAdmin"
                           "operation" "get-user"}}
   {:juxt.site/base-uri "https://auth.example.org"
    :juxt.site/installer-path "/permissions/by-role/{{role}}/{{operation}}"
    :juxt.site/parameters {"role" "SiteAdmin"
                           "operation" "put-user"}}

   ;; SiteBootstrap role
   ;; It is necessary for bootstrapping to be able to create a user

   ;; We could use our permission to install-resources but the user of
   ;; the users API is more convenient for specifying ad-hoc
   ;; parameters.
   {:juxt.site/base-uri "https://auth.example.org"
    :juxt.site/installer-path "/permissions/by-role/{{role}}/{{operation}}"
    :juxt.site/parameters {"role" "SiteBootstrap"
                           "operation" "put-user"}}
   {:juxt.site/base-uri "https://auth.example.org"
    :juxt.site/installer-path "/permissions/by-role/{{role}}/{{operation}}"
    :juxt.site/parameters {"role" "SiteBootstrap"
                           "operation" "assign-role"}}

   ;; SiteSystemQuery
   {:juxt.site/base-uri "https://auth.example.org"
    :juxt.site/installer-path "/permissions/by-role/{{role}}/{{operation}}"
    :juxt.site/parameters {"role" "SiteSystemQuery"
                           "operation" "get-users"}}
   {:juxt.site/base-uri "https://auth.example.org"
    :juxt.site/installer-path "/permissions/by-role/{{role}}/{{operation}}"
    :juxt.site/parameters {"role" "SiteSystemQuery"
                           "operation" "get-user"}}]}

 "juxt/site/applications-api"
 {:juxt.site/title "Apps API"
  :juxt.site/description "Applications API"
  :juxt.site/installers
  [
   ;; Operations
   {:juxt.site/base-uri "https://auth.example.org"
    :juxt.site/installer-path "/operations/oauth/get-applications"}

   ;; Endpoints
   {:juxt.site/base-uri "https://data.example.org"
    :juxt.site/installer-path "/_site/applications"}
   {:juxt.site/base-uri "https://data.example.org"
    :juxt.site/installer-path "/_site/applications.json"}

   ;; SiteSystemQuery
   ;; TODO

   ;; SiteAdmin
   {:juxt.site/base-uri "https://auth.example.org"
    :juxt.site/installer-path "/permissions/by-role/{{role}}/{{operation}}"
    :juxt.site/parameters {"role" "SiteAdmin" "operation" "oauth/get-applications"}}
   ]
  }

 "juxt/site/whoami-api"
 {:juxt.site/title "Whoami API"
  :juxt.site/description "Whoami API"
  :juxt.site/installers
  [{:juxt.site/base-uri "https://auth.example.org"
    :juxt.site/installer-path "/scopes/system/self-identification"}
   {:juxt.site/base-uri "https://auth.example.org"
    :juxt.site/installer-path "/operations/whoami"}
   {:juxt.site/base-uri "https://data.example.org"
    :juxt.site/installer-path "/_site/whoami"}
   {:juxt.site/base-uri "https://data.example.org"
    :juxt.site/installer-path "/_site/whoami.json"}
   {:juxt.site/base-uri "https://data.example.org"
    :juxt.site/installer-path "/_site/whoami.edn"}
   {:juxt.site/base-uri "https://auth.example.org"
    :juxt.site/installer-path "/operations/get-access-token"}
   {:juxt.site/base-uri "https://auth.example.org"
    :juxt.site/installer-path "/permissions/get-access-token"}
   {:juxt.site/base-uri "https://data.example.org"
    :juxt.site/installer-path "/_site/access-token"}
   {:juxt.site/base-uri "https://data.example.org"
    :juxt.site/installer-path "/_site/access-token.txt"}
   {:juxt.site/base-uri "https://auth.example.org"
    :juxt.site/installer-path "/permissions/whoami"}]}

 ;; TODO: Shouldn't SystemAPI be broken up into individual endpoints?
 #_"juxt/site/system-api"
 #_{:juxt.site/description "Site System API"
    :juxt.site/installers
    [ ;; Operations
     {:juxt.site/base-uri "https://auth.example.org"
      :juxt.site/installer-path "/operations/get-operations"}
     {:juxt.site/base-uri "https://auth.example.org"
      :juxt.site/installer-path "/permissions/get-operations"}
     {:juxt.site/base-uri "https://data.example.org"
      :juxt.site/installer-path "/_site/operations"}
     {:juxt.site/base-uri "https://data.example.org"
      :juxt.site/installer-path "/_site/operations.json"}
     {:juxt.site/base-uri "https://data.example.org"
      :juxt.site/installer-path "/_site/operations.edn"}

     ;; Roles (deprecated, replaced with SiteBootstrap and SiteSystemQuery)
     {:juxt.site/base-uri "https://data.example.org"
      :juxt.site/installer-path "/_site/roles/{{role}}"
      :juxt.site/parameters {"role" "System"}}
     {:juxt.site/base-uri "https://data.example.org"
      :juxt.site/installer-path "/_site/roles/{{role}}"
      :juxt.site/parameters {"role" "SystemReadonly"}}

     ;; Requests
     {:juxt.site/base-uri "https://auth.example.org"
      :juxt.site/installer-path "/operations/get-requests"}
     {:juxt.site/base-uri "https://data.example.org"
      :juxt.site/installer-path "/_site/requests"}

     ;; Permissions (mapping roles to operations)

     ;; System role
     {:juxt.site/base-uri "https://auth.example.org"
      :juxt.site/installer-path "/permissions/by-role/{{role}}/{{operation}}"
      :juxt.site/parameters {"role" "System" "operation" "get-users"}}
     {:juxt.site/base-uri "https://auth.example.org"
      :juxt.site/installer-path "/permissions/by-role/{{role}}/{{operation}}"
      :juxt.site/parameters {"role" "System" "operation" "get-user"}}
     {:juxt.site/base-uri "https://auth.example.org"
      :juxt.site/installer-path "/permissions/by-role/{{role}}/{{operation}}"
      :juxt.site/parameters {"role" "System" "operation" "put-user"}}
     {:juxt.site/base-uri "https://auth.example.org"
      :juxt.site/installer-path "/permissions/by-role/{{role}}/{{operation}}"
      :juxt.site/parameters {"role" "System" "operation" "get-requests"}}

     ;; SystemReadonly role
     {:juxt.site/base-uri "https://auth.example.org"
      :juxt.site/installer-path "/permissions/by-role/{{role}}/{{operation}}"
      :juxt.site/parameters {"role" "SystemReadonly" "operation" "get-users"}}
     {:juxt.site/base-uri "https://auth.example.org"
      :juxt.site/installer-path "/permissions/by-role/{{role}}/{{operation}}"
      :juxt.site/parameters {"role" "SystemReadonly" "operation" "get-user"}}
     {:juxt.site/base-uri "https://auth.example.org"
      :juxt.site/installer-path "/permissions/by-role/{{role}}/{{operation}}"
      :juxt.site/parameters {"role" "SystemReadonly" "operation" "get-requests"}}

     ;; Scopes
     ;; TODO: use these descriptions in the generation of openapi.json
     {:juxt.site/base-uri "https://auth.example.org"
      :juxt.site/installer-path "/scopes/system/read"}
     {:juxt.site/base-uri "https://auth.example.org"
      :juxt.site/installer-path "/scopes/system/write"}
     {:juxt.site/base-uri "https://auth.example.org"
      :juxt.site/installer-path "/scopes/system/self-identification"}]}

 "juxt/site/oauth-token-endpoint"
 {:juxt.site/title "OAuth2 token endpoint"
  :juxt.site/description "OAuth2 token endpoint"
  :juxt.site/installers
  [ ;; System permissions required
   {:juxt.site/base-uri "https://auth.example.org" :juxt.site/installer-path "/permissions/oauth/create-access-token"}
   {:juxt.site/base-uri "https://auth.example.org" :juxt.site/installer-path "/operations/oauth/create-access-token"}
   {:juxt.site/base-uri "https://auth.example.org" :juxt.site/installer-path "/operations/oauth/install-token-endpoint"}
   {:juxt.site/base-uri "https://auth.example.org" :juxt.site/installer-path "/permissions/system/install-oauth-token-endpoint"}
   {:juxt.site/base-uri "https://auth.example.org" :juxt.site/installer-path "/protection-spaces/client-credentials"}
   {:juxt.site/base-uri "https://auth.example.org" :juxt.site/installer-path "/oauth/token"}

   ;; Necessary to allow bootstrap registration of clients
   {:juxt.site/base-uri "https://auth.example.org" :juxt.site/installer-path "/operations/oauth/register-application"}

   {:juxt.site/base-uri "https://auth.example.org"
    :juxt.site/installer-path "/permissions/system/register-application"}

   {:juxt.site/base-uri "https://auth.example.org"
    :juxt.site/installer-path "/permissions/by-role/{{role}}/{{operation}}"
    :juxt.site/parameters {"role" "SiteAdmin"
                           "operation" "oauth/register-application"}}

   {:juxt.site/base-uri "https://auth.example.org"
    :juxt.site/installer-path "/permissions/by-role/{{role}}/{{operation}}"
    :juxt.site/parameters {"role" "SiteAdmin"
                           "operation" "oauth/install-token-endpoint"}}]}

 "juxt/site/keypair"
 {:juxt.site/title "Keypair"
  :juxt.site/description "Keypair"
  :juxt.site/parameters [["kid" {}]]
  :juxt.site/installers
  [{:juxt.site/base-uri "https://auth.example.org"
    :juxt.site/installer-path "/operations/generate-keypair"}
   {:juxt.site/base-uri "https://auth.example.org"
    :juxt.site/installer-path "/permissions/system/generate-keypair"}
   {:juxt.site/base-uri "https://auth.example.org"
    :juxt.site/installer-path "/keypairs/{{kid}}"
    :juxt.site/parameters {"kid" "{{kid}}"}}]}

 "juxt/site/oauth-authorization-endpoint"
 {:juxt.site/title "OAuth2 authorization endpoint"
  :juxt.site/description "OAuth2 authorization endpoint"
  :juxt.site/parameters
  [["session-scope"
    {:choices
     [{:label "Password-based form"
       :value "https://auth.example.org/session-scopes/form-login-session"}
      {:label "OpenID Connect"
       :value "https://auth.example.org/session-scopes/openid-login-session"}]}]
   ["authorization-code-length" {:default 20}]
   ["jti-length" {:default 20}]]
  :juxt.site/installers
  [ ;; System permissions required (for tests, mostly)
   {:juxt.site/base-uri "https://auth.example.org"
    :juxt.site/installer-path "/operations/oauth/install-authorize-endpoint"}
   {:juxt.site/base-uri "https://auth.example.org"
    :juxt.site/installer-path "/permissions/system/oauth/install-authorize-endpoint"}

   ;; Permission to call the operation as SiteAdmin
   {:juxt.site/base-uri "https://auth.example.org"
    :juxt.site/installer-path "/permissions/by-role/{{role}}/{{operation}}"
    :juxt.site/parameters {"role" "SiteAdmin"
                           "operation" "oauth/install-authorize-endpoint"}}

   {:juxt.site/base-uri "https://auth.example.org" :juxt.site/installer-path "/permissions/oauth/authorize"}
   {:juxt.site/base-uri "https://auth.example.org" :juxt.site/installer-path "/operations/oauth/authorize"}


   {:juxt.site/base-uri "https://auth.example.org" :juxt.site/installer-path "/permissions/oauth/view-owned-authorizations"}
   {:juxt.site/base-uri "https://auth.example.org" :juxt.site/installer-path "/operations/oauth/view-owned-authorizations"}

   {:juxt.site/base-uri "https://auth.example.org" :juxt.site/installer-path "/oauth/authorize"}]}

 "juxt/site/oauth-introspection-endpoint"
 {:juxt.site/title "OAuth2 RFC 7662 introspection endpoint"
  :juxt.site/description "OAuth2 RFC 7662 introspection endpoint"
  :juxt.site/installers
  [ ;; Introspection endpoint -- see RFC 7662
   {:juxt.site/base-uri "https://auth.example.org" :juxt.site/installer-path "/operations/oauth/introspect-token"}
   {:juxt.site/base-uri "https://auth.example.org" :juxt.site/installer-path "/permissions/oauth/introspect-token"}
   {:juxt.site/base-uri "https://auth.example.org" :juxt.site/installer-path "/operations/oauth/install-token-introspection-endpoint"}
   {:juxt.site/base-uri "https://auth.example.org" :juxt.site/installer-path "/permissions/system/install-token-introspection-endpoint"}
   {:juxt.site/base-uri "https://auth.example.org" :juxt.site/installer-path "/oauth/introspect"}]}

 "juxt/site/oauth-metadata-endpoints"
 {:juxt.site/description "OAuth2 RFC 8414 metadata endpoints"
  :juxt.site/installers
  [ ;; Metadata endpoint -- see RFC 8414
   {:juxt.site/base-uri "https://auth.example.org" :juxt.site/installer-path "/permissions/oauth/get-authorization-server-metadata"}
   {:juxt.site/base-uri "https://auth.example.org" :juxt.site/installer-path "/operations/oauth/get-authorization-server-metadata"}
   {:juxt.site/base-uri "https://auth.example.org" :juxt.site/installer-path "/operations/oauth/install-metadata-endpoint"}
   {:juxt.site/base-uri "https://auth.example.org" :juxt.site/installer-path "/permissions/system/oauth/install-metadata-endpoint"}
   {:juxt.site/base-uri "https://auth.example.org" :juxt.site/installer-path "/.well-known/oauth-authorization-server"}

   ;; JWKS endpoint -- see RFC 7517 - see https://juxt.eu.auth0.com/.well-known/jwks.json
   {:juxt.site/base-uri "https://auth.example.org" :juxt.site/installer-path "/operations/oauth/get-jwks-document"}
   {:juxt.site/base-uri "https://auth.example.org" :juxt.site/installer-path "/permissions/oauth/get-jwks-document"}
   {:juxt.site/base-uri "https://auth.example.org" :juxt.site/installer-path "/operations/oauth/install-jwks-document"}
   {:juxt.site/base-uri "https://auth.example.org" :juxt.site/installer-path "/permissions/system/oauth/install-jwks-document"}
   {:juxt.site/base-uri "https://auth.example.org" :juxt.site/installer-path "/.well-known/jwks.json"}]}

 "juxt/site/protection-spaces"
 {:juxt.site/title "Protection spaces"
  :juxt.site/description "Protection spaces"
  :juxt.site/installers
  [{:juxt.site/base-uri "https://auth.example.org"
    :juxt.site/installer-path "/operations/put-protection-space"}

   ;; for testing (perhaps)
   {:juxt.site/base-uri "https://auth.example.org"
    :juxt.site/installer-path "/permissions/system/put-protection-space"}

   {:juxt.site/base-uri "https://auth.example.org"
    :juxt.site/installer-path "/permissions/by-role/{{role}}/{{operation}}"
    :juxt.site/parameters {"role" "SiteAdmin"
                           "operation" "put-protection-space"}}
   {:juxt.site/base-uri "https://auth.example.org"
    :juxt.site/installer-path "/protection-spaces/bearer"}
   {:juxt.site/base-uri "https://auth.example.org"
    :juxt.site/installer-path "/protection-spaces/basic"}]}

 "juxt/site/system-api-openapi"
 {:juxt.site/title "System API OpenAPI"
  :juxt.site/description "OpenAPI documentation for System API"
  :juxt.site/installers
  [{:juxt.site/base-uri "https://data.example.org"
    :juxt.site/installer-path "/_site/openapi.json"}]}

 "juxt/site/pass-support"
 {:juxt.site/title "Support for JUXT Pass"
  :juxt.site/description "See https://github.com/juxt-site/pass"
  :juxt.site/installers
  [{:juxt.site/base-uri "https://data.example.org"
    :juxt.site/installer-path "/_site/juxt-pass.js"}
   {:juxt.site/base-uri "https://data.example.org"
    :juxt.site/installer-path "/_site/oauth-service-worker.js"}]}

 "demo/petstore/operations"
 {:juxt.site/title "Petstore Demo"
  :juxt.site/dependencies ["juxt/site/openapi"]
  :juxt.site/installers
  [{:juxt.site/base-uri "https://auth.example.org"
    :juxt.site/installer-path "/operations/petstore/add-pet"}
   {:juxt.site/base-uri "https://auth.example.org"
    :juxt.site/installer-path "/operations/petstore/get-pet-by-id"}
   {:juxt.site/base-uri "https://auth.example.org"
    :juxt.site/installer-path "/operations/petstore/delete-pet-by-id"}
   {:juxt.site/base-uri "https://auth.example.org"
    :juxt.site/installer-path "/operations/petstore/update-pet-by-id"}
   {:juxt.site/base-uri "https://auth.example.org"
    :juxt.site/installer-path "/operations/petstore/find-by-status"}
   {:juxt.site/base-uri "https://auth.example.org"
    :juxt.site/installer-path "/operations/petstore/all-pets"}
   {:juxt.site/base-uri "https://auth.example.org"
    :juxt.site/installer-path "/operations/petstore/find-by-tags"}
   {:juxt.site/base-uri "https://auth.example.org"
    :juxt.site/installer-path "/operations/petstore/order/place"}
   {:juxt.site/base-uri "https://auth.example.org"
    :juxt.site/installer-path "/operations/petstore/order/inventory"}
   {:juxt.site/base-uri "https://auth.example.org"
    :juxt.site/installer-path "/operations/petstore/order/get-by-id"}
   {:juxt.site/base-uri "https://auth.example.org"
    :juxt.site/installer-path "/operations/petstore/order/delete-by-id"}

   ;; TODO: Not sure that roles need to be declared in the resource
   ;; server rather than the auth server. They are becoming more
   ;; closely tied with users now.
   {:juxt.site/base-uri "https://data.example.org"
    :juxt.site/installer-path "/_site/roles/{{role}}"
    :juxt.site/parameters {"role" "PetstoreOwner"}
    :juxt.site/description "This role is for owners of petstores"}

   {:juxt.site/base-uri "https://auth.example.org"
    :juxt.site/installer-path "/scopes/petstore/read"}

   {:juxt.site/base-uri "https://auth.example.org"
    :juxt.site/installer-path "/scopes/petstore/write"}

   {:juxt.site/base-uri "https://auth.example.org"
    :juxt.site/installer-path "/permissions/by-role/{{role}}/{{operation}}"
    :juxt.site/parameters {"role" "PetstoreOwner"
                           "operation" "petstore/add-pet"}}

   {:juxt.site/base-uri "https://auth.example.org"
    :juxt.site/installer-path "/permissions/by-role/{{role}}/{{operation}}"
    :juxt.site/parameters {"role" "PetstoreOwner"

                           "operation" "petstore/get-pet-by-id"}}
   {:juxt.site/base-uri "https://auth.example.org"
    :juxt.site/installer-path "/permissions/by-role/{{role}}/{{operation}}"
    :juxt.site/parameters {"role" "PetstoreOwner"
                           "operation" "petstore/find-by-status"}}
   {:juxt.site/base-uri "https://auth.example.org"
    :juxt.site/installer-path "/permissions/by-role/{{role}}/{{operation}}"
    :juxt.site/parameters {"role" "PetstoreOwner"
                           "operation" "petstore/all-pets"}}
   {:juxt.site/base-uri "https://auth.example.org"
    :juxt.site/installer-path "/permissions/by-role/{{role}}/{{operation}}"
    :juxt.site/parameters {"role" "PetstoreOwner"
                           "operation" "petstore/find-by-tags"}}
   {:juxt.site/base-uri "https://auth.example.org"
    :juxt.site/installer-path "/permissions/by-role/{{role}}/{{operation}}"
    :juxt.site/parameters {"role" "PetstoreOwner"
                           "operation" "petstore/delete-pet-by-id"}}
   {:juxt.site/base-uri "https://auth.example.org"
    :juxt.site/installer-path "/permissions/by-role/{{role}}/{{operation}}"
    :juxt.site/parameters {"role" "PetstoreOwner"
                           "operation" "petstore/update-pet-by-id"}}

   {:juxt.site/base-uri "https://auth.example.org"
    :juxt.site/installer-path "/permissions/by-role/{{role}}/{{operation}}"
    :juxt.site/parameters {"role" "PetstoreOwner"
                           "operation" "petstore/order/place"}}

   {:juxt.site/base-uri "https://auth.example.org"
    :juxt.site/installer-path "/permissions/by-role/{{role}}/{{operation}}"
    :juxt.site/parameters {"role" "PetstoreOwner"
                           "operation" "petstore/order/delete-by-id"}}

   {:juxt.site/base-uri "https://auth.example.org"
    :juxt.site/installer-path "/permissions/by-role/{{role}}/{{operation}}"
    :juxt.site/parameters {"role" "PetstoreOwner"
                           "operation" "petstore/order/inventory"}}

   {:juxt.site/base-uri "https://auth.example.org"
    :juxt.site/installer-path "/permissions/by-role/{{role}}/{{operation}}"
    :juxt.site/parameters {"role" "PetstoreOwner"
                           "operation" "petstore/order/get-by-id"}}]}

 "demo/petstore/pets"
 {:juxt.site/title "Some pets!"
  :juxt.site/installers
  [{:juxt.site/base-uri "https://data.example.org" :juxt.site/installer-path "/petstore/pet/saffron"}
   {:juxt.site/base-uri "https://data.example.org" :juxt.site/installer-path "/petstore/pet/cooper"}
   {:juxt.site/base-uri "https://data.example.org" :juxt.site/installer-path "/petstore/pet/pumpkin-and-knight"}
   {:juxt.site/base-uri "https://data.example.org" :juxt.site/installer-path "/petstore/pet/unknown"}
   ]
  }

 "juxt/site/sessions"
 {:juxt.site/title "Sessions"
  :juxt.site/description "Sessions"
  :juxt.site/installers
  [{:juxt.site/base-uri "https://auth.example.org"
    :juxt.site/installer-path "/operations/put-session-scope"}
   #_{:juxt.site/base-uri "https://auth.example.org"
      :juxt.site/installer-path "/permissions/system/put-session-scope"}
   {:juxt.site/base-uri "https://auth.example.org"
    :juxt.site/installer-path "/permissions/by-role/{{role}}/{{operation}}"
    :juxt.site/parameters {"role" "SiteAdmin"
                           "operation" "put-session-scope"}}]}

 "juxt/site/user-model"
 {:juxt.site/title "User model"
  :juxt.site/description
  "Operations to establish users upon a common model"
  :juxt.site/installers
  [{:juxt.site/base-uri "https://auth.example.org" :juxt.site/installer-path "/operations/oauth/register-scope"}
   {:juxt.site/base-uri "https://auth.example.org" :juxt.site/installer-path "/permissions/system/oauth/register-scope"}
   {:juxt.site/base-uri "https://auth.example.org" :juxt.site/installer-path "/scopes/system/read"}
   {:juxt.site/base-uri "https://auth.example.org" :juxt.site/installer-path "/scopes/system/write"}
   {:juxt.site/base-uri "https://auth.example.org" :juxt.site/installer-path "/operations/get-users"}
   {:juxt.site/base-uri "https://auth.example.org" :juxt.site/installer-path "/operations/get-user"}
   {:juxt.site/base-uri "https://auth.example.org" :juxt.site/installer-path "/operations/put-user"}
   {:juxt.site/base-uri "https://auth.example.org" :juxt.site/installer-path "/permissions/system/put-user"}]}

 "juxt/site/login-form"
 {:juxt.site/title "Login form"
  :juxt.site/description "Login form"
  :juxt.site/installers
  [{:juxt.site/base-uri "https://auth.example.org" :juxt.site/installer-path "/operations/login"}
   {:juxt.site/base-uri "https://auth.example.org" :juxt.site/installer-path "/permissions/login"}
   {:juxt.site/base-uri "https://auth.example.org" :juxt.site/installer-path "/permissions/system/create-login-resource"}
   {:juxt.site/base-uri "https://auth.example.org" :juxt.site/installer-path "/operations/create-login-resource"}
   {:juxt.site/base-uri "https://auth.example.org"
    :juxt.site/installer-path "/permissions/by-role/{{role}}/{{operation}}"
    :juxt.site/parameters {"role" "SiteAdmin"
                           "operation" "create-login-resource"}}
   {:juxt.site/base-uri "https://auth.example.org" :juxt.site/installer-path "/permissions/system/put-session-scope"}
   {:juxt.site/base-uri "https://auth.example.org" :juxt.site/installer-path "/session-scopes/form-login-session"}
   {:juxt.site/base-uri "https://auth.example.org" :juxt.site/installer-path "/login-with-form"}
   ]}

 "juxt/site/logout"
 {:juxt.site/installers
  [{:juxt.site/base-uri "https://auth.example.org" :juxt.site/installer-path "/operations/logout"}
   {:juxt.site/base-uri "https://auth.example.org" :juxt.site/installer-path "/permissions/logout"}
   {:juxt.site/base-uri "https://auth.example.org" :juxt.site/installer-path "/operations/create-logout-resource"}
   {:juxt.site/base-uri "https://auth.example.org" :juxt.site/installer-path "/permissions/system/create-logout-resource"}
   {:juxt.site/base-uri "https://auth.example.org"
    :juxt.site/installer-path "/permissions/by-role/{{role}}/{{operation}}"
    :juxt.site/parameters {"role" "SiteAdmin"
                           "operation" "create-logout-resource"}}
   {:juxt.site/base-uri "https://auth.example.org" :juxt.site/installer-path "/logout"}
   ]}

 "juxt/site/test-scopes"
 {:juxt.site/description "Test scopes"
  :juxt.site/installers
  [{:juxt.site/base-uri "https://auth.example.org" :juxt.site/installer-path "/scopes/test/read"}
   {:juxt.site/base-uri "https://auth.example.org" :juxt.site/installer-path "/scopes/test/write"}
   {:juxt.site/base-uri "https://auth.example.org" :juxt.site/installer-path "/scopes/test/admin"}]}

 "juxt/site/test-clients"
 {:juxt.site/description "Test clients"
  :juxt.site/installers
  [{:juxt.site/base-uri "https://auth.example.org" :juxt.site/installer-path "/applications/test/public-global-scope-app"}
   {:juxt.site/base-uri "https://auth.example.org" :juxt.site/installer-path "/applications/test/public-read-scope-app"}
   {:juxt.site/base-uri "https://auth.example.org" :juxt.site/installer-path "/applications/test/public-read-write-scope-app"}
   {:juxt.site/base-uri "https://auth.example.org" :juxt.site/installer-path "/applications/test/confidential-global-scope-app"}
   {:juxt.site/base-uri "https://auth.example.org" :juxt.site/installer-path "/applications/test/clientA"}]}

 ;; Just used in system-api-test - TODO: could definitely be merged with juxt/site/test-clients
 "juxt/site/system-test-clients"
 {:juxt.site/description "System test clients"
  :juxt.site/installers
  [{:juxt.site/base-uri "https://auth.example.test" :juxt.site/installer-path "/applications/global-scope-app"}
   {:juxt.site/base-uri "https://auth.example.test" :juxt.site/installer-path "/applications/read-only-app"}
   {:juxt.site/base-uri "https://auth.example.test" :juxt.site/installer-path "/applications/read-write-app"}
   {:juxt.site/base-uri "https://auth.example.test" :juxt.site/installer-path "/applications/site-cli"}]}

 "juxt/site/system-client"
 {:juxt.site/title "System client"
  :juxt.site/description "Register a client with the SiteBootstrap and SiteSystemQuery roles. System clients are able to authenticate themselves with the client_credentials grant."
  :juxt.site/parameters [["client-id" {}]
                         ["client-secret" {:optional true}]]
  :juxt.site/installers
  [{:juxt.site/base-uri "https://auth.example.org"
    :juxt.site/installer-path "/applications/{{client-id}}"
    :juxt.site/parameters
    {"clientid" "{{client-id}}"}}
   {:juxt.site/base-uri "https://data.example.org"
    :juxt.site/installer-path "/_site/application-role-assignments/{{clientid}}-{{rolename}}"
    :juxt.site/parameters
    {"clientid" "{{client-id}}"
     "rolename" "SiteBootstrap"}}
   {:juxt.site/base-uri "https://data.example.org"
    :juxt.site/installer-path "/_site/application-role-assignments/{{clientid}}-{{rolename}}"
    :juxt.site/parameters
    {"clientid" "{{client-id}}"
     "rolename" "SiteSystemQuery"}}

   ;; TODO: This very-powerful role has been added temporarily as a
   ;; quick fix to get 'site bootstrap' to work. Needs some thought as
   ;; to how much to automate via 'site bootstrap' versus the
   ;; requirement to get the command-line user to specify an openid
   ;; account or credentials to trust.
   {:juxt.site/base-uri "https://data.example.org"
    :juxt.site/installer-path "/_site/application-role-assignments/{{clientid}}-{{rolename}}"
    :juxt.site/parameters
    {"clientid" "{{client-id}}"
     "rolename" "SiteAdmin"}}]}

 "juxt/site/browser-client"
 {:juxt.site/title "Browser client"
  :juxt.site/installers
  [{:juxt.site/base-uri "https://auth.example.org"
    :juxt.site/installer-path "/applications/browser"}
   {:juxt.site/base-uri "https://data.example.org"
    :juxt.site/installer-path "/_site/browser/browser-oauth-redirect.html"}]}

 "juxt/site/whoami-client"
 {:juxt.site/title "Whoami client - a personal profile page"
  :juxt.site/installers
  [{:juxt.site/base-uri "https://auth.example.org"
    :juxt.site/installer-path "/applications/whoami-client"}]}

 "juxt/site/swagger-ui"
 {:juxt.site/title "Swagger UI"
  :juxt.site/installers
  [{:juxt.site/base-uri "https://auth.example.org"
    :juxt.site/installer-path "/applications/swagger-ui"}]}

 "juxt/site/retool-client"
 {:juxt.site/title "Retool client"
  :juxt.site/installers
  [{:juxt.site/base-uri "https://auth.example.org"
    :juxt.site/installer-path "/applications/retool"}]}

 "juxt/site/example-users"
 {:juxt.site/description "Example users"
  :juxt.site/installers
  [ ;; Alice
   {:juxt.site/base-uri "https://data.example.org"
    :juxt.site/installer-path "/_site/users/{{username}}"
    :juxt.site/parameters {"username" "alice"
                           "fullname" "Alice"}}
   {:juxt.site/base-uri "https://data.example.org"
    :juxt.site/installer-path "/_site/user-identities/{{username}}"
    :juxt.site/parameters {"username" "alice"
                           "password" "garden"}}
   ;; Bob
   {:juxt.site/base-uri "https://data.example.org"
    :juxt.site/installer-path "/_site/users/{{username}}"
    :juxt.site/parameters {"username" "bob"
                           "fullname" "Bob"}}
   {:juxt.site/base-uri "https://data.example.org"
    :juxt.site/installer-path "/_site/user-identities/{{username}}"
    :juxt.site/parameters {"username" "bob"
                           "password" "walrus"}}
   ;; Carlos
   {:juxt.site/base-uri "https://data.example.org"
    :juxt.site/installer-path "/_site/users/{{username}}"
    :juxt.site/parameters {"username" "carlos"
                           "fullname" "Carlos"}}
   {:juxt.site/base-uri "https://data.example.org"
    :juxt.site/installer-path "/_site/user-identities/{{username}}"
    :juxt.site/parameters {"username" "carlos"
                           "password" "jackal"}}]}

 "juxt/site/user-role-assignment"
 {:juxt.site/title "User role assignment"
  :juxt.site/parameters [["username" {}]
                         ["rolename" {}]]
  :juxt.site/installers
  [{:juxt.site/base-uri "https://data.example.org"
    :juxt.site/installer-path "/_site/user-role-assignments/{{username}}-{{rolename}}"
    :juxt.site/parameters {"username" "{{username}}"
                           "rolename" "{{rolename}}"}}]}

 "juxt/site/application-role-assignment"
 {:juxt.site/title "Client role assignment"
  :juxt.site/parameters [["clientid" {}]
                         ["rolename" {}]]
  :juxt.site/installers
  [{:juxt.site/base-uri "https://data.example.org"
    :juxt.site/installer-path "/_site/application-role-assignments/{{clientid}}-{{rolename}}"
    :juxt.site/parameters {"clientid" "{{clientid}}"
                           "rolename" "{{rolename}}"}}]}

 "juxt/site/hospital-demo"
 {:juxt.site/description "Hospital demo resources"
  :juxt.site/installers
  [{:juxt.site/base-uri "https://data.example.org" :juxt.site/installer-path "/hospital-demo/_site/operations/get-patient"}

   {:juxt.site/base-uri "https://data.example.org"
    :juxt.site/installer-path "/hospital-demo/_site/permissions/{{username}}/get-any-patient"
    :juxt.site/parameters {"username" "alice"}}
   {:juxt.site/base-uri "https://data.example.org"
    :juxt.site/installer-path "/hospital-demo/_site/permissions/{{username}}/get-patient/{{pid}}"
    :juxt.site/parameters {"username" "bob" "pid" "004"}}
   {:juxt.site/base-uri "https://data.example.org"
    :juxt.site/installer-path "/hospital-demo/_site/permissions/{{username}}/get-patient/{{pid}}"
    :juxt.site/parameters {"username" "bob" "pid" "009"}}
   {:juxt.site/base-uri "https://data.example.org"
    :juxt.site/installer-path "/hospital-demo/_site/permissions/{{username}}/get-patient/{{pid}}"
    :juxt.site/parameters {"username" "bob" "pid" "010"}}

   {:juxt.site/base-uri "https://data.example.org" :juxt.site/installer-path "/hospital-demo/_site/operations/list-patients"}

   {:juxt.site/base-uri "https://data.example.org"
    :juxt.site/installer-path "/hospital-demo/_site/permissions/{{username}}/list-patients"
    :juxt.site/parameters {"username" "alice"}}
   {:juxt.site/base-uri "https://data.example.org"
    :juxt.site/installer-path "/hospital-demo/_site/permissions/{{username}}/list-patients"
    :juxt.site/parameters {"username" "bob"}}

   {:juxt.site/base-uri "https://data.example.org" :juxt.site/installer-path "/hospital-demo/_site/operations/register-patient-measurement"}
   {:juxt.site/base-uri "https://data.example.org" :juxt.site/installer-path "/hospital-demo/_site/permissions/system/register-patient-measurement"}
   {:juxt.site/base-uri "https://data.example.org" :juxt.site/installer-path "/hospital-demo/_site/operations/get-doctor"}

   {:juxt.site/base-uri "https://data.example.org"
    :juxt.site/installer-path "/hospital-demo/_site/permissions/{{username}}/get-doctor"
    :juxt.site/parameters {"username" "alice"}}
   {:juxt.site/base-uri "https://data.example.org"
    :juxt.site/installer-path "/hospital-demo/_site/permissions/{{username}}/get-doctor"
    :juxt.site/parameters {"username" "bob"}}

   {:juxt.site/base-uri "https://data.example.org" :juxt.site/installer-path "/hospital-demo/_site/operations/read-any-measurement"}
   {:juxt.site/base-uri "https://data.example.org" :juxt.site/installer-path "/hospital-demo/_site/operations/register-doctor"}
   {:juxt.site/base-uri "https://data.example.org" :juxt.site/installer-path "/hospital-demo/_site/permissions/system/register-doctor"}
   {:juxt.site/base-uri "https://data.example.org" :juxt.site/installer-path "/hospital-demo/_site/permissions/system/register-patient"}
   {:juxt.site/base-uri "https://data.example.org" :juxt.site/installer-path "/hospital-demo/_site/operations/register-patient"}
   {:juxt.site/base-uri "https://data.example.org" :juxt.site/installer-path "/hospital-demo/_site/operations/assign-doctor-to-patient"}
   {:juxt.site/base-uri "https://data.example.org" :juxt.site/installer-path "/hospital-demo/_site/permissions/system/assign-doctor-to-patient"}

   {:juxt.site/base-uri "https://data.example.org"
    :juxt.site/installer-path "/hospital-demo/_site/permissions/{{username}}/read-any-measurement"
    :juxt.site/parameters {"username" "alice"}}
   {:juxt.site/base-uri "https://data.example.org"
    :juxt.site/installer-path "/hospital-demo/_site/permissions/{{username}}/read-any-measurement"
    :juxt.site/parameters {"username" "bob"}}

   ;; Hospital data
   {:juxt.site/base-uri "https://data.example.org" :juxt.site/installer-path "/hospital-demo/patients/"}
   {:juxt.site/base-uri "https://data.example.org" :juxt.site/installer-path "/hospital-demo/doctors/001"}
   {:juxt.site/base-uri "https://data.example.org" :juxt.site/installer-path "/hospital-demo/doctors/002"}
   {:juxt.site/base-uri "https://data.example.org" :juxt.site/installer-path "/hospital-demo/doctors/003"}
   {:juxt.site/base-uri "https://data.example.org" :juxt.site/installer-path "/hospital-demo/doctors/004"}
   {:juxt.site/base-uri "https://data.example.org" :juxt.site/installer-path "/hospital-demo/patients/001"}
   {:juxt.site/base-uri "https://data.example.org" :juxt.site/installer-path "/hospital-demo/patients/002"}
   {:juxt.site/base-uri "https://data.example.org" :juxt.site/installer-path "/hospital-demo/patients/003"}
   {:juxt.site/base-uri "https://data.example.org" :juxt.site/installer-path "/hospital-demo/patients/004"}
   {:juxt.site/base-uri "https://data.example.org" :juxt.site/installer-path "/hospital-demo/patients/005"}
   {:juxt.site/base-uri "https://data.example.org" :juxt.site/installer-path "/hospital-demo/patients/006"}
   {:juxt.site/base-uri "https://data.example.org" :juxt.site/installer-path "/hospital-demo/patients/007"}
   {:juxt.site/base-uri "https://data.example.org" :juxt.site/installer-path "/hospital-demo/patients/008"}
   {:juxt.site/base-uri "https://data.example.org" :juxt.site/installer-path "/hospital-demo/patients/009"}
   {:juxt.site/base-uri "https://data.example.org" :juxt.site/installer-path "/hospital-demo/patients/010"}
   {:juxt.site/base-uri "https://data.example.org" :juxt.site/installer-path "/hospital-demo/patients/011"}
   {:juxt.site/base-uri "https://data.example.org" :juxt.site/installer-path "/hospital-demo/patients/012"}
   {:juxt.site/base-uri "https://data.example.org" :juxt.site/installer-path "/hospital-demo/patients/013"}
   {:juxt.site/base-uri "https://data.example.org" :juxt.site/installer-path "/hospital-demo/patients/014"}
   {:juxt.site/base-uri "https://data.example.org" :juxt.site/installer-path "/hospital-demo/patients/015"}
   {:juxt.site/base-uri "https://data.example.org" :juxt.site/installer-path "/hospital-demo/patients/016"}
   {:juxt.site/base-uri "https://data.example.org" :juxt.site/installer-path "/hospital-demo/patients/017"}
   {:juxt.site/base-uri "https://data.example.org" :juxt.site/installer-path "/hospital-demo/patients/018"}
   {:juxt.site/base-uri "https://data.example.org" :juxt.site/installer-path "/hospital-demo/patients/019"}
   {:juxt.site/base-uri "https://data.example.org" :juxt.site/installer-path "/hospital-demo/patients/020"}

   {:juxt.site/base-uri "https://data.example.org"
    :juxt.site/installer-path "/hospital-demo/assignments/patient/{{pid}}/doctor/{{did}}"
    :juxt.site/parameters {"pid" "001" "did" "001"}}
   {:juxt.site/base-uri "https://data.example.org"
    :juxt.site/installer-path "/hospital-demo/assignments/patient/{{pid}}/doctor/{{did}}"
    :juxt.site/parameters {"pid" "002" "did" "001"}}
   {:juxt.site/base-uri "https://data.example.org"
    :juxt.site/installer-path "/hospital-demo/assignments/patient/{{pid}}/doctor/{{did}}"
    :juxt.site/parameters {"pid" "003" "did" "001"}}
   {:juxt.site/base-uri "https://data.example.org"
    :juxt.site/installer-path "/hospital-demo/assignments/patient/{{pid}}/doctor/{{did}}"
    :juxt.site/parameters {"pid" "004" "did" "002"}}
   {:juxt.site/base-uri "https://data.example.org"
    :juxt.site/installer-path "/hospital-demo/assignments/patient/{{pid}}/doctor/{{did}}"
    :juxt.site/parameters {"pid" "005" "did" "001"}}
   {:juxt.site/base-uri "https://data.example.org"
    :juxt.site/installer-path "/hospital-demo/assignments/patient/{{pid}}/doctor/{{did}}"
    :juxt.site/parameters {"pid" "005" "did" "002"}}
   {:juxt.site/base-uri "https://data.example.org"
    :juxt.site/installer-path "/hospital-demo/assignments/patient/{{pid}}/doctor/{{did}}"
    :juxt.site/parameters {"pid" "006" "did" "003"}}
   {:juxt.site/base-uri "https://data.example.org"
    :juxt.site/installer-path "/hospital-demo/assignments/patient/{{pid}}/doctor/{{did}}"
    :juxt.site/parameters {"pid" "010" "did" "003"}}]}

 "juxt/site/roles"
 {:juxt.site/title "Roles operations"
  :juxt.site/description
  "Operations to establish and assign roles to users"
  :juxt.site/installers
  [{:juxt.site/base-uri "https://auth.example.org"
    :juxt.site/installer-path "/permissions/by-role/{{role}}/{{operation}}"
    :juxt.site/parameters {"role" "SiteAdmin"
                           "operation" "put-role"}}

   {:juxt.site/base-uri "https://auth.example.org" :juxt.site/installer-path "/operations/assign-role"}
   {:juxt.site/base-uri "https://auth.example.org" :juxt.site/installer-path "/permissions/system/assign-role"}
   {:juxt.site/base-uri "https://auth.example.org"
    :juxt.site/installer-path "/permissions/by-role/{{role}}/{{operation}}"
    :juxt.site/parameters {"role" "SiteAdmin"
                           "operation" "assign-role"}}
   ]}

 "juxt/site/password-based-user-identity"
 {:juxt.site/title "Password Based User Identity"
  :juxt.site/description "Password-based user identities"
  :juxt.site/installers
  [{:juxt.site/base-uri "https://auth.example.org" :juxt.site/installer-path "/operations/register-password-based-user-identity"}
   {:juxt.site/base-uri "https://auth.example.org" :juxt.site/installer-path "/permissions/system/register-password-based-user-identity"}
   ]}

 "juxt/site/openid-support"
 {:juxt.site/title "OpenID Connect support"
  :juxt.site/description "Configure Site as an OpenID Connect client to authenticate resource owners"
  :juxt.site/installers
  [{:juxt.site/base-uri "https://auth.example.org" :juxt.site/installer-path "/operations/login-with-openid"}
   {:juxt.site/base-uri "https://auth.example.org" :juxt.site/installer-path "/permissions/login-with-openid"}

   {:juxt.site/base-uri "https://auth.example.org" :juxt.site/installer-path "/operations/openid/exchange-code-for-id-token"}
   {:juxt.site/base-uri "https://auth.example.org" :juxt.site/installer-path "/permissions/openid/exchange-code-for-id-token"}
   {:juxt.site/base-uri "https://auth.example.org" :juxt.site/installer-path "/operations/register-openid-issuer"}
   {:juxt.site/base-uri "https://auth.example.org" :juxt.site/installer-path "/operations/register-openid-client"}
   {:juxt.site/base-uri "https://auth.example.org" :juxt.site/installer-path "/operations/register-openid-user-identity"}
   {:juxt.site/base-uri "https://auth.example.org" :juxt.site/installer-path "/operations/install-openid-login-endpoint"}
   {:juxt.site/base-uri "https://auth.example.org" :juxt.site/installer-path "/operations/install-openid-callback-endpoint"}

   {:juxt.site/base-uri "https://auth.example.org" :juxt.site/installer-path "/session-scopes/openid-login-session"}

   {:juxt.site/base-uri "https://auth.example.org"
    :juxt.site/installer-path "/permissions/by-role/{{role}}/{{operation}}"
    :juxt.site/parameters {"role" "SiteAdmin"
                           "operation" "register-openid-issuer"}}
   {:juxt.site/base-uri "https://auth.example.org"
    :juxt.site/installer-path "/permissions/by-role/{{role}}/{{operation}}"
    :juxt.site/parameters {"role" "SiteAdmin"
                           "operation" "register-openid-client"}}
   {:juxt.site/base-uri "https://auth.example.org"
    :juxt.site/installer-path "/permissions/by-role/{{role}}/{{operation}}"
    :juxt.site/parameters {"role" "SiteAdmin"
                           "operation" "register-openid-user-identity"}}
   {:juxt.site/base-uri "https://auth.example.org"
    :juxt.site/installer-path "/permissions/by-role/{{role}}/{{operation}}"
    :juxt.site/parameters {"role" "SiteAdmin"
                           "operation" "install-openid-login-endpoint"}}
   {:juxt.site/base-uri "https://auth.example.org"
    :juxt.site/installer-path "/permissions/by-role/{{role}}/{{operation}}"
    :juxt.site/parameters {"role" "SiteAdmin"
                           "operation" "install-openid-callback-endpoint"}}]}

 "juxt/site/openid-issuer"
 {:juxt.site/title "OpenID Connect issuer"
  :juxt.site/parameters
  [["iss" {:label "Issuer"}]]
  :juxt.site/installers
  [{:juxt.site/base-uri "https://auth.example.org" :juxt.site/installer-path "/openid/issuers/{{iss|urlescape}}"}]}

 "juxt/site/openid-client"
 {:juxt.site/title "OpenID Connect client"
  :juxt.site/parameters
  [["iss" {:label "Issuer"}]
   ["client-id" {:label "Client ID"}]
   ["client-secret" {:label "Client Secret" :password true}]]
  :juxt.site/installers
  [{:juxt.site/base-uri "https://auth.example.org" :juxt.site/installer-path "/openid/clients/{{iss|urlescape}}/{{client-id}}"}]}

 "juxt/site/openid-user-identity"
 {:juxt.site/title "OpenID Connect user identity"
  :juxt.site/parameters
  [["iss" {:label "Issuer"}]
   ["nickname" {:label "Nickname"}]
   ["user" {:label "Associated user (URI)"}]]
  :juxt.site/installers
  [{:juxt.site/base-uri "https://data.example.org"
    :juxt.site/installer-path "/_site/openid-user-identities/{{iss|urlescape}}/nickname/{{nickname}}"}]}

 "juxt/site/login-with-openid"
 {:juxt.site/title "OpenID redirect"
  :juxt.site/parameters
  [["iss" {:label "Issuer"}]
   ["client-id" {:label "Client ID"}]]
  :juxt.site/installers
  [
   {:juxt.site/base-uri "https://auth.example.org" :juxt.site/installer-path "/openid/callback"}
   {:juxt.site/base-uri "https://auth.example.org" :juxt.site/installer-path "/login-with-openid"}]}

 "juxt/site/testing/basic-auth-protected-resource"
 {:juxt.site/installers
  [{:juxt.site/base-uri "https://auth.example.org" :juxt.site/installer-path "/operations/testing/basic-auth-protected-resource-operation"}
   {:juxt.site/base-uri "https://auth.example.org" :juxt.site/installer-path "/permissions/testing/basic-auth-protected-resource-operation"}
   {:juxt.site/base-uri "https://data.example.org" :juxt.site/installer-path "/_site/testing/basic-auth-protected-resource"}
   {:juxt.site/base-uri "https://data.example.org" :juxt.site/installer-path "/_site/testing/client-credentials-protected-resource"}
   ]}

 "juxt/site/testing/system-permissions"
 {:juxt.site/description "A client, with the SiteAdmin role, for use in tests"
  :juxt.site/installers
  [{:juxt.site/base-uri "https://auth.example.test" :juxt.site/installer-path "/permissions/system/register-application"}]}

 "juxt/site/testing/test-admin-client"
 {:juxt.site/description "A client, with the SiteAdmin role, for use in tests"
  :juxt.site/installers
  [{:juxt.site/base-uri "https://auth.example.test" :juxt.site/installer-path "/applications/test-admin-client"}
   {:juxt.site/base-uri "https://data.example.org"
    :juxt.site/installer-path "/_site/application-role-assignments/{{clientid}}-{{rolename}}"
    :juxt.site/parameters {"clientid" "test-admin-client" "rolename" "SiteAdmin"}}]}}
